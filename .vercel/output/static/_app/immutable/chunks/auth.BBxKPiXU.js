import{w as ut}from"./entry.BP7SI6wp.js";var z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(J){return J&&J.__esModule&&Object.prototype.hasOwnProperty.call(J,"default")?J.default:J}function it(J){throw new Error('Could not dynamically require "'+J+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Y={exports:{}};Y.exports;(function(J){(function(){function g($,e){return e?it($):$.slice?g[a($)]:function(s,y){$(s={exports:{}}),g[a(y)]=s.exports};function a(s){return s.split("/").slice(-1).toString().replace(".js","")}}var G=J;g(function($){String.random=function(a,s){var y="";for(a=a||24,s=s||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";a-- >0;)y+=s.charAt(Math.floor(Math.random()*s.length));return y},String.match=function(a,s){var y,p;return typeof a!="string"?!1:(typeof s=="string"&&(s={"=":s}),s=s||{},y=s["="]||s["*"]||s[">"]||s["<"],a===y?!0:p!==s["="]?!1:(y=s["*"]||s[">"],a.slice(0,(y||"").length)===y?!0:p!==s["*"]?!1:p!==s[">"]&&p!==s["<"]?a>=s[">"]&&a<=s["<"]:p!==s[">"]&&a>=s[">"]||p!==s["<"]&&a<=s["<"]))},String.hash=function(a,s){if(typeof a=="string"){if(s=s||0,!a.length)return s;for(var y=0,p=a.length,f;y<p;++y)f=a.charCodeAt(y),s=(s<<5)-s+f,s|=0;return s}};var e=Object.prototype.hasOwnProperty;Object.plain=function(a){return a?a instanceof Object&&a.constructor===Object||Object.prototype.toString.call(a).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(a,s){for(var y in a)if(e.call(a,y)&&(!s||s.indexOf(y)==-1))return!1;return!0},Object.keys=Object.keys||function(a){var s=[];for(var y in a)e.call(a,y)&&s.push(y);return s},function(){var a,s=setTimeout,y=0,p=0,f=typeof setImmediate!=""+a&&setImmediate||function(o,v){return typeof MessageChannel==""+a?s:((o=new MessageChannel).port1.onmessage=function(S){S.data==""&&v()},function(S){v=S,o.port2.postMessage("")})}(),u=s.check=s.check||typeof performance!=""+a&&performance||{now:function(){return+new Date}};s.hold=s.hold||9,s.poll=s.poll||function(o){if(s.hold>=u.now()-y&&p++<3333){o();return}f(function(){y=u.now(),o()},p=0)}}(),function(){var a=setTimeout,s=a.turn=a.turn||function(v){y.push(v)==1&&p(o)},y=s.s=[],p=a.poll,f=0,u,o=function(){(u=y[f++])&&u(),(f==y.length||f==99)&&(y=s.s=y.slice(f),f=0),y.length&&p(o)}}(),function(){var a,s=setTimeout,y=s.turn;(s.each=s.each||function(p,f,u,o){o=o||9,function v(S,n,d){if(n=(S=(p||[]).splice(0,o)).length){for(var l=0;l<n&&a===(d=f(S[l]));l++);if(a===d){y(v);return}}u&&u(d)}()})()}()})(g,"./shim"),g(function($){$.exports=function e(u,s,y){if(!u)return{to:e};var p,f=typeof s=="function",u=(this.tag||(this.tag={}))[u]||f&&(this.tag[u]={tag:u,to:e._={next:function(v){var S;(S=this.to)&&S.next(v)}}});if(f){var o={off:e.off||(e.off=function(){if(this.next===e._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=e._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:e._,next:s,the:u,on:this,as:y};return(o.back=u.last||u).to=o,u.last=o}return(u=u.to)&&p!==s&&u.next(s),u}})(g,"./onto"),g(function($){$.exports=function(e){return e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"&&e!=1/0&&e!=-1/0&&e===e||!!e&&typeof e["#"]=="string"&&Object.keys(e).length===1&&e["#"]}})(g,"./valid"),g(function($){g("./shim");function e(){var u=+new Date;return p<u?(s=0,p=u+e.drift):p=u+(s+=1)/y+e.drift}e.drift=0;var a=-1/0,s=0,y=999,p=a,f;e.is=function(u,o,v){var S=o&&u&&u._&&u._[">"]||v;if(S)return typeof(S=S[o])=="number"?S:a},e.ify=function(u,o,v,S,n){(u=u||{})._=u._||{},n&&(u._["#"]=n);var d=u._[">"]||(u._[">"]={});return f!==o&&o!=="_"&&(typeof v=="number"&&(d[o]=v),f!==S&&(u[o]=S)),u},$.exports=e})(g,"./state"),g(function($){g("./shim");function e(a){var s={s:{}},y=s.s;a=a||{max:999,age:1e3*9},s.check=function(f){return y[f]?p(f):!1};var p=s.track=function(f){var u=y[f]||(y[f]={});return u.was=s.now=+new Date,s.to||(s.to=setTimeout(s.drop,a.age+9)),p.ed&&p.ed(f),u};return s.drop=function(f){s.to=null,s.now=+new Date;var u=Object.keys(y);console.STAT&&console.STAT(s.now,+new Date-s.now,"dup drop keys"),setTimeout.each(u,function(o){var v=y[o];v&&(f||a.age)>s.now-v.was||delete y[o]},0,99)},s}$.exports=e})(g,"./dup"),g(function($){g("./onto"),$.exports=function(s,y){if(this.on){var p=(this.opt||{}).lack||9e3;if(typeof s!="function"){if(!s)return;var u=s["#"]||s,f=(this.tag||"")[u];return f?(y&&(f=this.on(u,y),clearTimeout(f.err),f.err=setTimeout(function(){f.off()},p)),!0):void 0}var u=y&&y["#"]||e(9);if(!s)return u;var o=this.on(u,s,y);return o.err=o.err||setTimeout(function(){o.off(),o.next({err:"Error: No ACK yet.",lack:!0})},p),u}};var e=String.random||function(){return Math.random().toString(36).slice(2)}})(g,"./ask"),g(function($){function e(n){return n instanceof e?(this._={$:this}).$:this instanceof e?e.create(this._={$:this,opt:n}):new e(n)}e.is=function(n){return n instanceof e||n&&n._&&n===n._.$||!1},e.version=.202,e.chain=e.prototype,e.chain.toJSON=function(){},g("./shim"),e.valid=g("./valid"),e.state=g("./state"),e.on=g("./onto"),e.dup=g("./dup"),e.ask=g("./ask"),function(){e.create=function(i){i.root=i.root||i,i.graph=i.graph||{},i.on=i.on||e.on,i.ask=i.ask||e.ask,i.dup=i.dup||e.dup();var m=i.$.opt(i.opt);return i.once||(i.on("in",n,i),i.on("out",n,i),i.on("put",w,i),e.on("create",i),i.on("create",i)),i.once=1,m};function n(i){if(i){if(i.out===n){this.to.next(i);return}var m=this,j=m.as,D=j.at||j,O=D.$,T=D.dup,N,C=i.DBG;if((N=i["#"])||(N=i["#"]=s(9)),!T.check(N)){if(T.track(N),N=i._,i._=typeof N=="function"?N:function(){},i.$&&i.$===(i.$._||"").$||(i.$=O),i["@"]&&!i.put&&t(i),!D.ask(i["@"],i))if(C&&(C.u=+new Date),i.put){d(i);return}else i.get&&e.on.get(i,O);C&&(C.uc=+new Date),m.to.next(i),C&&(C.ua=+new Date),!(i.nts||i.NTS)&&(i.out=n,D.on("out",i),C&&(C.ue=+new Date))}}}function d(i){if(i){var m=i._||"",j=m.root=((m.$=i.$||"")._||"").root;if(i["@"]&&m.faith&&!m.miss){i.out=n,j.on("out",i);return}m.latch=j.hatch,m.match=j.hatch=[];var D=i.put,O=m.DBG=i.DBG,T=+new Date;if(E=E||T,!(D["#"]&&D["."])){O&&(O.p=T),m["#"]=i["#"],m.msg=i,m.all=0,m.stun=1;var N=Object.keys(D);console.STAT&&console.STAT(T,((O||m).pk=+new Date)-T,"put sort");var C=0,U,M,I,P,K,R,F;(function H(X){if(U!=C){if(U=C,!(I=N[C])){console.STAT&&console.STAT(T,((O||m).pd=+new Date)-T,"put"),r(m);return}(P=D[I])?(F=P._)?I!==F["#"]?R=h+_(I)+"soul not same.":(K=F[">"])||(R=h+_(I)+"no state."):R=h+_(I)+"no meta.":R=h+_(I)+"no node.",M=Object.keys(P||{})}if(R){i.err=m.err=R,r(m);return}var tt=0,W;for(X=X||0;X++<9&&(W=M[tt++]);)if(W!=="_"){var L=P[W],et=K[W];if(o===et){R=h+_(W)+"on"+_(I)+"no state.";break}if(!p(L)){R=h+_(W)+"on"+_(I)+"bad "+typeof L+_(L);break}l(L,W,I,et,i),++B}if((M=M.slice(tt)).length){y(H);return}++C,M=null,H(X)})()}}}e.on.put=d;function l(i,m,j,D,O){var T=O._||"",N=T.root,C=N.graph,U,M=C[j]||v,I=f(M,m,1),P=M[m],K=T.DBG;(U=console.STAT)&&(!C[j]||!P)&&(U.has=(U.has||0)+1);var R=A();if(D>R){setTimeout(function(){l(i,m,j,D,O)},(U=D-R)>x?x:U),console.STAT&&console.STAT((K||T).Hf=+new Date,U,"future");return}if(!(D<I)&&!(!T.faith&&D===I&&(i===P||k(i)<=k(P))&&!T.miss)){T.stun++;var F=O["#"]+T.all++,H={toString:function(){return F},_:T};H.toJSON=H.toString,N.dup.track(H)["#"]=O["#"],K&&(K.ph=K.ph||+new Date),N.on("put",{"#":H,"@":O["@"],put:{"#":j,".":m,":":i,">":D},ok:O.ok,_:T})}}function w(i){var m;(m=(i._||"").DBG)&&(m.pa=+new Date,m.pm=m.pm||+new Date);var j=this,D=j.as,O=D.graph,T=i._,N=i.put,C=N["#"],U=N["."],M=N[":"],I=N[">"];i["#"];var P;(P=T.msg)&&(P=P.put)&&(P=P[C])&&u(P,U,I,M,C),O[C]=u(O[C],U,I,M,C),(P=(D.next||"")[C])&&P.on("in",i),r(T),j.to.next(i)}function r(i,m){var j;if(!i.stop&&!(!i.err&&0<--i.stun)&&(i.stop=1,!!(j=i.root))){var D=i.match;D.end=1,D===j.hatch&&(!(D=i.latch)||D.end?delete j.hatch:j.hatch=D),i.hatch&&i.hatch(),setTimeout.each(i.match,function(O){O&&O()}),!(!(m=i.msg)||i.err||m.err)&&(m.out=n,i.root.on("out",m),b())}}function t(i){var m=i["@"]||"",j;if(!(j=m._)){var D=(D=i.$)&&(D=D._)&&(D=D.root)&&(D=D.dup);if(!(D=D.check(m)))return;i["@"]=D["#"]||i["@"];return}j.acks=(j.acks||0)+1,(j.err=i.err)&&(i["@"]=j["#"],r(j)),j.ok=i.ok||j.ok,!j.stop&&!j.crack&&(j.crack=j.match&&j.match.push(function(){c(j)})),c(j)}function c(i){!i||!i.root||i.stun||i.acks!==i.all||i.root.on("in",{"@":i["#"],err:i.err,ok:i.err?o:i.ok||{"":1}})}var h="Error: Invalid graph!",_=function(i){return" '"+(""+i).slice(0,9)+"...' "},k=JSON.stringify,x=2147483647,A=e.state,B=0,E,b=function(){B>999&&B/-(E-(E=+new Date))>1&&(e.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),b=function(){B=0})}}(),function(){e.on.get=function(d,l){var w=l._,r=d.get,t=r["#"],c=w.graph[t],h=r["."],_=w.next||(w.next={}),k=_[t],x=d._||{},A=x.DBG=d.DBG;if(A&&(A.g=+new Date),!c)return w.on("get",d);if(h){if((typeof h!="string"||o===c[h])&&!((k||"").next||"")[h]){w.on("get",d);return}c=u({},h,f(c,h),c[h],t)}c&&n(d,c),w.on("get",d)};function n(d,l){var w=+new Date,r=d._||{},t=r.DBG=d.DBG,c=d["#"],h=s(9),_=Object.keys(l||"").sort(),k=((l||"")._||"")["#"];_.length;var x=d.$._.root,A=l===x.graph[k];console.STAT&&console.STAT(w,((t||r).gk=+new Date)-w,"got keys"),l&&function B(){w=+new Date;for(var E=0,b,i={},m;E<9&&(b=_[E++]);)u(i,b,f(l,b),l[b],k);_=_.slice(E),(m={})[k]=i,i=m;var j;A&&(j=function(){},j.ram=j.faith=!0),m=_.length,console.STAT&&console.STAT(w,-(w-(w=+new Date)),"got copied some"),t&&(t.ga=+new Date),x.on("in",{"@":c,"#":h,put:i,"%":m?h=s(9):o,$:x.$,_:j,DBG:t,FOO:1}),console.STAT&&console.STAT(w,+new Date-w,"got in"),m&&setTimeout.turn(B)}(),l||x.on("in",{"@":d["#"]})}e.on.get.ack=n}(),function(){e.chain.opt=function(n){n=n||{};var d=this,l=d._,w=n.peers||n;return Object.plain(n)||(n={}),Object.plain(l.opt)||(l.opt=n),typeof w=="string"&&(w=[w]),Object.plain(l.opt.peers)||(l.opt.peers={}),w instanceof Array&&(n.peers={},w.forEach(function(r){var t={};t.id=t.url=r,n.peers[r]=l.opt.peers[r]=l.opt.peers[r]||t})),a(n,function r(t){var c=this[t];if(this&&this.hasOwnProperty(t)||typeof c=="string"||Object.empty(c)){this[t]=c;return}c&&c.constructor!==Object&&!(c instanceof Array)||a(c,r)}),l.opt.from=n,e.on("opt",l),l.opt.uuid=l.opt.uuid||function(t){return e.state().toString(36).replace(".","")+String.random(t||12)},d}}();var a=function(n,d){Object.keys(n).forEach(d,n)},s=String.random,y=setTimeout.turn,p=e.valid,f=e.state.is,u=e.state.ify,o,v={},S;e.log=function(){return!e.log.off&&S.log.apply(S,arguments),[].slice.call(arguments).join(" ")},e.log.once=function(n,d,l){return(l=e.log.once)[n]=l[n]||0,l[n]++||e.log(d)},typeof window<"u"&&((window.GUN=window.Gun=e).window=window);try{typeof G<"u"&&(G.exports=e)}catch{}$.exports=e,(e.window||{}).console=(e.window||{}).console||{log:function(){}},(S=console).only=function(n,d){return S.only.i&&n===S.only.i&&S.only.i++&&(S.log.apply(S,arguments)||d)},e.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(g,"./root"),g(function($){var e=g("./root");e.chain.back=function(y,p){var f;if(y=y||1,y===-1||y===1/0)return this._.root.$;if(y===1)return(this._.back||this._).$;var u=this,o=u._;if(typeof y=="string"&&(y=y.split(".")),y instanceof Array){var v=0,S=y.length,f=o;for(v;v<S;v++)f=(f||a)[y[v]];return s!==f?p?u:f:(f=o.back)?f.$.back(y,p):void 0}if(typeof y=="function"){for(var n,f={back:o};(f=f.back)&&s===(n=y(f,p)););return n}return typeof y=="number"?(o.back||o).$.back(y-1):this};var a={},s})(g,"./back"),g(function($){var e=g("./root");e.chain.chain=function(r){var t=this,c=t._,h=new(r||t).constructor(t),_=h._,k;return _.root=k=c.root,_.id=++k.once,_.back=t._,_.on=e.on,_.on("in",e.on.in,_),_.on("out",e.on.out,_),h};function a(r){var t,c=this.as,h=c.back,_=c.root,k;if(r.$||(r.$=c.$),this.to.next(r),c.err){c.on("in",{put:c.put=o,$:c.$});return}if(t=r.get){if(_.pass&&(_.pass[c.id]=c),c.lex&&Object.keys(c.lex).forEach(function(x){k[x]=c.lex[x]},k=r.get=r.get||{}),t["#"]||c.soul){if(t["#"]=t["#"]||c.soul,r["#"]||(r["#"]=v(9)),h=_.$.get(t["#"])._,t=t["."]){if(n(h.put,t)&&(k=h.ask&&h.ask[t],(h.ask||(h.ask={}))[t]=h.$.get(t)._,h.on("in",{get:t,put:{"#":h.soul,".":t,":":h.put[t],">":l(_.graph[h.soul],t)}}),k))return}else{if(k=h.ask&&h.ask[""],(h.ask||(h.ask={}))[""]=h,o!==h.put&&(h.on("in",h),k))return;r.$=h.$}return _.ask(f,r),_.on("in",r)}if(t["."])return c.get?(r={get:{".":c.get},$:c.$},(h.ask||(h.ask={}))[c.get]=r.$._,h.on("out",r)):(r={get:c.lex?r.get:{},$:c.$},h.on("out",r));if((c.ask||(c.ask={}))[""]=c,c.get)return t["."]=c.get,(h.ask||(h.ask={}))[c.get]=r.$._,h.on("out",r)}return h.on("out",r)}e.on.out=a;function s(r,t){t=t||this.as;var c=t.root,h=r.$||(r.$=t.$),_=(h||"")._||u,k=r.put||"",x=k["#"],A=k["."],B=o!==k["="]?k["="]:k[":"],E=k[">"]||-1/0,b;if(o!==r.put&&(o===k["#"]||o===k["."]||o===k[":"]&&o===k["="]||o===k[">"])){if(!S(k)){if(!(x=((k||"")._||"")["#"])){console.log("chain not yet supported for",k,"...",r,t);return}return h=t.root.$.get(x),setTimeout.each(Object.keys(k).sort(),function(i){i=="_"||o===(E=l(k,i))||t.on("in",{$:h,put:{"#":x,".":i,"=":k[i],">":E},VIA:r})})}t.on("in",{$:_.back.$,put:{"#":x=_.back.soul,".":A=_.has||_.get,"=":k,">":l(_.back.put,A)},via:r});return}(r.seen||"")[t.id]||((r.seen||(r.seen=function(){}))[t.id]=t,t!==_&&(Object.keys(r).forEach(function(i){k[i]=r[i]},k={}),k.get=t.get||k.get,!t.soul&&!t.has?k.$$$=k.$$$||t.$:_.soul&&(k.$=t.$,k.$$=k.$$||_.$),r=k),p(r,t),(t.soul||r.$$)&&E>=l(c.graph[x],A)&&((k=c.$.get(x)._).put=w(k.put,A,E,B,x)),!_.soul&&E>=l(c.graph[x],A)&&(b=(c.$.get(x)._.next||"")[A])&&(b.put=B,typeof(k=S(B))=="string"&&(b.put=c.$.get(k)._.put||B)),this.to&&this.to.next(r),t.any&&setTimeout.each(Object.keys(t.any),function(i){(i=t.any[i])&&i(r)},0,99),t.echo&&setTimeout.each(Object.keys(t.echo),function(i){(i=t.echo[i])&&i.on("in",r)},0,99),((r.$$||"")._||_).soul&&(b=t.next)&&(b=b[A])&&(k={},Object.keys(r).forEach(function(i){k[i]=r[i]}),k.$=(r.$$||r.$).get(k.get=A),delete k.$$,delete k.$$$,b.on("in",k)),y(r,t))}e.on.in=s;function y(r,t){if(t=t||this.as||r.$._,!(r.$$&&this!==e.on)&&!(!r.put||t.soul)){var c=r.put||"",h=c["="]||c[":"],A,_=t.root,k=_.$.get(c["#"]).get(c["."])._;if(typeof(h=S(h))!="string"){this===e.on&&((k.echo||(k.echo={}))[t.id]=t);return}if(!((k.echo||(k.echo={}))[t.id]&&!(_.pass||"")[t.id])){if(A=_.pass){if(A[h+t.id])return;A[h+t.id]=1}(k.echo||(k.echo={}))[t.id]=t,t.has&&(t.link=h);var x=_.$.get(k.link=h)._;(x.echo||(x.echo={}))[k.id]=k;var A=t.ask||"";(A[""]||t.lex)&&x.on("out",{get:{"#":h}}),setTimeout.each(Object.keys(A),function(B,E){!B||!(E=A[B])||E.on("out",{get:{"#":h,".":B}})},0,99)}}}e.on.link=y;function p(r,t){var c=r.put||"",h=o!==c["="]?c["="]:c[":"],_=t.root,k,x;if(o===h){if(t.soul&&o!==t.put||(x=(r.$$||r.$||"")._||"",r["@"]&&(o!==x.put||o!==t.put)))return;(k=t.link||r.linked)&&delete(_.$.get(k)._.echo||"")[t.id],t.has&&(t.link=null),t.put=o,setTimeout.each(Object.keys(t.next||""),function(A,B){(B=t.next[A])&&(k&&delete(_.$.get(k).get(A)._.echo||"")[B.id],B.on("in",{get:A,put:o,$:B.$}))},0,99);return}t.soul||r.$$||(k=S(h),x=r.$._||"",!((k===x.link||t.has&&!x.link)&&!((_.pass||"")[t.id]&&typeof k!="string"))&&(delete(x.echo||"")[t.id],p({get:t.get,put:o,$:r.$,linked:r.linked=r.linked||x.link},t)))}e.on.unlink=p;function f(r,t){var c=this.as,h=c.$._;h.root;var _=c.get||"",k=(r.put||"")[_["#"]]||"";if(!r.put||typeof _["."]=="string"&&o===k[_["."]]){if(o!==h.put||!h.soul&&!h.has)return;h.ack=(h.ack||0)+1,h.on("in",{get:h.get,put:h.put=o,$:h.$,"@":r["@"]});return}(r._||{}).miss=1,e.on.put(r)}var u={},o,v=String.random,S=e.valid,n=function(r,t){return r&&Object.prototype.hasOwnProperty.call(r,t)},d=e.state,l=d.is,w=d.ify})(g,"./chain"),g(function($){var e=g("./root");e.chain.get=function(o,v,S){var n,d;if(typeof o=="string"){if(o.length==0)return(n=this.chain())._.err={err:e.log("0 length key!",o)},v&&v.call(n,n._.err),n;var l=this,w=l._,r=w.next||p;(n=r[o])||(n=o&&a(o,l)),n=n&&n.$}else if(typeof o=="function"){let x=function(A,B,E){if(!x.stun&&!((O=c.pass)&&!O[h])){var b=A.$._,i=(A.$$||"")._,m=(i||b).put,j=!b.has&&!b.soul,D={},O;if((j||u===m)&&(m=u===((O=A.put)||"")["="]?u===(O||"")[":"]?O:O[":"]:O["="]),typeof(O=e.valid(m))=="string"&&(m=u===(O=c.$.get(O)._.put)?t.not?u:m:O),!(t.not&&u===m)){if(u===t.stun){if((O=c.stun)&&O.on&&(w.$.back(function(T){if(O.on(""+T.id,D={}),(D.run||0)<x.id)return D}),!D.run&&O.on(""+b.id,D={}),!D.run&&i&&O.on(""+i.id,D={}),x.id>D.run&&((!D.stun||D.stun.end)&&(D.stun=O.on("stun"),D.stun=D.stun&&D.stun.last),D.stun&&!D.stun.end))){(D.stun.add||(D.stun.add={}))[h]=function(){x(A,B,1)};return}if(u===m&&(E=0),(O=c.hatch)&&!O.end&&u===t.hatch&&!E){if(_[b.$._.id])return;_[b.$._.id]=1,O.push(function(){x(A,B,1)});return}_={}}if(c.pass){if(c.pass[h+b.id])return;c.pass[h+b.id]=1}if(t.on){t.ok.call(b.$,m,b.get,A,B||x);return}if(t.v2020){t.ok(A,B||x);return}Object.keys(A).forEach(function(T){O[T]=A[T]},O={}),A=O,A.put=m,t.ok.call(t.as,A,B||x)}}};if(v===!0)return s(this,o,v,S),this;n=this;var w=n._,t=v||{},c=w.root,h;t.at=w,t.ok=o;var _={};return x.at=w,(w.any||(w.any={}))[h=String.random(7)]=x,x.off=function(){x.stun=1,w.any&&delete w.any[h]},x.rid=y,x.id=t.run||++c.once,d=c.pass,(c.pass={})[h]=1,t.out=t.out||{get:{}},w.on("out",t.out),c.pass=d,n}else{if(typeof o=="number")return this.get(""+o,v,S);if(typeof(d=f(o))=="string")return this.get(d,v,S);(d=this.get.next)&&(n=d(this,o))}return n?(v&&typeof v=="function"&&n.get(v,S),n):((n=this.chain())._.err={err:e.log("Invalid get request!",o)},v&&v.call(n,n._.err),n)};function a(o,v){var S=v._,n=S.next,d=v.chain(),l=d._;return n||(n=S.next={}),n[l.get=o]=l,v===S.root.$?l.soul=o:(S.soul||S.has)&&(l.has=o),l}function s(o,v,S,n){var d=o._,l=0,w;return(w=d.soul||d.link)?v(w,n,d):d.jam?d.jam.push([v,n]):(d.jam=[[v,n]],o.get(function(t,c){if(!(u===t.put&&!d.root.opt.super&&(w=Object.keys(d.root.opt.peers).length)&&++l<=w)){c.rid(t);var h=(h=t.$)&&h._||{},_=0,k;for(w=d.jam,delete d.jam;k=w[_++];){var x=k[0];k=k[1],x&&x(h.link||h.soul||e.valid(t.put)||((t.put||{})._||{})["#"],k,t,c)}}},{out:{get:{".":!0}}}),o)}function y(o){var v=this.at||this.on;if(!o||v.soul||v.has)return this.off();if(o=(o=(o=o.$||o)._||o).id){v.map;var S;if((S=this.seen||(this.seen={}))[o])return!0;S[o]=!0}}var p={},f=e.valid,u})(g,"./get"),g(function($){var e=g("./root");e.chain.put=function(n,d,l){var w=this,r=w._,t=r.root;l=l||{},l.root=r.root,l.run||(l.run=t.once),a(l,r.id),l.ack=l.ack||d,l.via=l.via||w,l.data=l.data||n,l.soul||(l.soul=r.soul||typeof d=="string"&&d);var c=l.state=l.state||e.state();return typeof n=="function"?(n(function(h){l.data=h,w.put(f,f,l)}),w):l.soul?(l.$=t.$.get(l.soul),l.todo=[{it:l.data,ref:l.$}],l.turn=l.turn||o,l.ran=l.ran||s,function h(){var _=l.todo,k=_.pop(),x=k.it;k.ref&&k.ref._.id;var A,B,E,b,i;if(a(l,k.ref),(b=k.todo)&&(B=b.pop(),x=x[B],b.length&&_.push(k)),B&&(_.path||(_.path=[])).push(B),!(A=v(x))&&!(i=e.is(x))){if(!Object.plain(x)){s.err(l,"Invalid data: "+p(x)+" at "+(l.via.back(function(O){O.get&&b.push(O.get)},b=[])||b.join("."))+"."+(_.path||[]).join("."));return}for(var m=l.seen||(l.seen=[]),j=m.length;j--;)if(x===(b=m[j]).it){A=x=b.link;break}}if(B&&A)k.node=S(k.node,B,c,x);else{let O=function(T,N){var C=E.link["#"];N&&(N.off(),N.rid(T));var U=C||T.soul||(b=(T.$$||T.$)._||"").soul||b.link||((b=b.put||"")._||"")["#"]||b["#"]||((b=T.put||"")&&T.$$?b["#"]:(b["="]||b[":"]||"")["#"]);if(!C&&a(l,T.$),!U&&!k.link["#"]){(k.wait||(k.wait=[])).push(function(){O(T,N)});return}U||(U=[],(T.$$||T.$).back(function(M){if(b=M.soul||M.link)return U.push(b);U.push(M.get)}),U=U.reverse().join("/")),E.link["#"]=U,!i&&(((l.graph||(l.graph={}))[U]=E.node||(E.node={_:{}}))._["#"]=U),delete l.wait[D],E.wait&&setTimeout.each(E.wait,function(M){M&&M()}),l.ran(l)};if(!l.seen){s.err(l,"Data at root of graph must be a node (an object).");return}l.seen.push(E={it:x,link:{},todo:i?[]:Object.keys(x).sort().reverse(),path:(_.path||[]).slice(),up:k}),k.node=S(k.node,B,c,E.link),!i&&E.todo.length&&_.push(E);var D=l.seen.length;(l.wait||(l.wait={}))[D]="",b=(E.ref=i?x:B?k.ref.get(B):k.ref)._,(b=x&&(x._||"")["#"]||b.soul||b.link)?O({soul:b}):E.ref.get(O,{run:l.run,v2020:1,out:{get:{".":" "}}})}if(!_.length)return l.ran(l);l.turn(h)}(),w):(y(l),w)};function a(n,d){if(d){d=(d._||"").id||d;var l=n.root.stun||(n.root.stun={on:e.on}),w={},r;n.stun||(n.stun=l.on("stun",function(){})),(r=l.on(""+d))&&r.the.last.next(w),!(w.run>=n.run)&&l.on(""+d,function(t){if(n.stun.end){this.off(),this.to.next(t);return}t.run=t.run||n.run,t.stun=t.stun||n.stun})}}function s(n){if(n.err){s.end(n.stun,n.root);return}if(!(n.todo.length||n.end||!Object.empty(n.wait))){n.end=1;var d=n.$.back(-1)._,l=d.root,w=d.ask(function(h){l.on("ack",h),h.err&&!h.lack&&e.log(h),++r>(n.acks||0)&&this.off(),n.ack&&n.ack(h,this)},n.opt),r=0,t=n.stun,c;(c=function(){t&&(s.end(t,l),setTimeout.each(Object.keys(t=t.add||""),function(h){(h=t[h])&&h()}))}).hatch=c,n.ack&&!n.ok&&(n.ok=n.acks||9),n.via._.on("out",{put:n.out=n.graph,ok:n.ok&&{"@":n.ok+1},opt:n.opt,"#":w,_:c})}}s.end=function(n,d){n.end=u,n.the.to===n&&n===n.the.last&&delete d.stun,n.off()},s.err=function(n,d){(n.ack||u).call(n,n.out={err:n.err=e.log(d)}),n.ran(n)};function y(n){var d=n.via._,l;n.via=n.via.back(function(w){if(w.soul||!w.get)return w.$;l=n.data,(n.data={})[w.get]=l}),(!n.via||!n.via._.soul)&&(n.via=d.root.$.get(((n.data||"")._||"")["#"]||d.$.back("opt.uuid")())),n.via.put(n.data,n.ack,n)}function p(n,d){return n&&(d=n.constructor)&&d.name||typeof n}var f,u=function(){},o=setTimeout.turn,v=e.valid,S=e.state.ify})(g,"./put"),g(function($){var e=g("./root");g("./chain"),g("./back"),g("./put"),g("./get"),$.exports=e})(g,"./index"),g(function($){var e=g("./index");e.chain.on=function(y,p,f,u){var o=this,v=o._;v.root;var S;if(typeof y=="string")return p?(S=v.on(y,p,f||v,u),f&&f.$&&(f.subs||(f.subs=[])).push(S),o):v.on(y);var n=p;return(n=n===!0?{change:!0}:n||{}).not=1,n.on=1,o.get(y,n),o},e.chain.once=function(y,p){if(p=p||{},!y)return a(this);var f=this,u=f._,o=u.root;u.put;var v=String.random(7),S;return f.get(function(n,d,l,w){var r=this,t=r._,c=t.one||(t.one={});if(w.stun||c[v]==="")return;if((S=e.valid(n))===!0){h();return}if(typeof S=="string")return;clearTimeout((u.one||"")[v]),clearTimeout(c[v]),c[v]=setTimeout(h,p.wait||99);function h(_){if(!t.has&&!t.soul&&(t={put:n,get:d}),s===(S=t.put)&&(S=((l.$$||"")._||"").put),typeof e.valid(S)=="string"&&(S=o.$.get(S)._.put,S===s&&!_)){c[v]=setTimeout(function(){h(1)},p.wait||99);return}w.stun||c[v]!==""&&(c[v]="",(u.soul||u.has)&&w.off(),y.call(r,S,t.get),clearTimeout(c[v]))}},{on:1}),f};function a(y,p,f){return e.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(f=y.chain())._.nix=y.once(function(u,o){f._.on("in",this._)}),f._.lex=y._.lex,f}e.chain.off=function(){var y=this,p=y._,f,u=p.back;if(u)return p.ack=0,(f=u.next)&&f[p.get]&&delete f[p.get],(f=u.any)&&(delete u.any,u.any={}),(f=u.ask)&&delete f[p.get],(f=u.put)&&delete f[p.get],(f=p.soul)&&delete u.root.graph[f],(f=p.map)&&Object.keys(f).forEach(function(o,v){v=f[o],v.link&&u.root.$.get(v.link).off()}),(f=p.next)&&Object.keys(f).forEach(function(o,v){v=f[o],v.$.off()}),p.on("off",{}),y};var s})(g,"./on"),g(function($){var e=g("./index"),a=e.chain.get.next;e.chain.get.next=function(f,u){var o;return Object.plain(u)?(o=((o=u["#"])||"")["="]||o)?f.get(o):((o=f.chain()._).lex=u,f.on("in",function(v){String.match(v.get||(v.put||"")["."],u["."]||u["#"]||u)&&o.on("in",v),this.to.next(v)}),o.$):(a||y)(f,u)},e.chain.map=function(f,u,o){var v=this,S=v._,n,d;return Object.plain(f)&&(n=f["."]?f:{".":f},f=p),f?(e.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),d=v.chain(),v.map().on(function(l,w,r,t){var c=(f||y).call(this,l,w,r,t);if(p!==c){if(l===c)return d._.on("in",r);if(e.is(c))return d._.on("in",c._);var h={};Object.keys(r.put).forEach(function(_){h[_]=r.put[_]},h),h["="]=c,d._.on("in",{get:w,put:h})}}),d):((d=S.each)||((S.each=d=v.chain())._.lex=n||d._.lex||S.lex,d._.nix=v.back("nix"),v.on("in",s,d._)),d)};function s(f){this.to.next(f);var u=this.as,o=f.$,v=o._,S=f.put,n;!v.soul&&!f.$$||(n=u.lex)&&!String.match(f.get||(S||"")["."],n["."]||n["#"]||n)||e.on.link(f,u)}var y=function(){},p})(g,"./map"),g(function($){var e=g("./index");e.chain.set=function(a,s,y){var p=this,f=p.back(-1),u,o;return s=s||function(){},y=y||{},y.item=y.item||a,(u=((a||"")._||"")["#"])&&((a={})["#"]=u),typeof(o=e.valid(a))=="string"?p.get(u=o).put(a,s,y):e.is(a)?(p.put(function(v){a.get(function(S,n,d){if(!S)return s.call(p,{err:e.log('Only a node can be linked! Not "'+d.put+'"!')});(o={})[S]={"#":S},v(o)},!0)}),a):(Object.plain(a)&&(a=f.get(u=p.back("opt.uuid")()).put(a)),p.get(u||f.back("opt.uuid")(7)).put(a,s,y))}})(g,"./set"),g(function($){g("./shim");var e=function(){},a=JSON.parseAsync||function(f,u,o){var v,S=+new Date;try{u(v,JSON.parse(f,o),s.sucks(+new Date-S))}catch(n){u(n)}},s=JSON.stringifyAsync||function(f,u,o,v){var S,n=+new Date;try{u(S,JSON.stringify(f,o,v),s.sucks(+new Date-n))}catch(d){u(d)}};s.sucks=function(f){f>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),s.sucks=e)};function y(f){var u=function(){},o=f.opt||{};o.log=o.log||console.log,o.gap=o.gap||o.wait||0,o.max=o.max||(o.memory?o.memory*999*999:3e8)*.3,o.pack=o.pack||o.max*.01*.01,o.puff=o.puff||9;var v=setTimeout.turn||setTimeout,S=f.dup,n=S.check,d=S.track,l=u.hear=function(t,c){if(t){if(o.max<=t.length)return u.say({dam:"!",err:"Message too big!"},c);u===this&&(l.d+=t.length||0,++l.c);var h=c.SH=+new Date,_=t[0],k;if(_==="["){a(t,function(x,A){if(x||!A)return u.say({dam:"!",err:"DAM JSON parse error."},c);console.STAT&&console.STAT(+new Date,A.length,"# on hear batch");var B=o.puff;(function E(){for(var b=+new Date,i=0,m;i<B&&(m=A[i++]);)u.hear(m,c);A=A.slice(i),console.STAT&&console.STAT(b,+new Date-b,"hear loop"),w(c),A.length&&v(E,0)})()}),t="";return}if(_==="{"||(t["#"]||Object.plain(t))&&(k=t)){if(k)return l.one(k,c,h);a(t,function(x,A){if(x||!A)return u.say({dam:"!",err:"DAM JSON parse error."},c);l.one(A,c,h)});return}}};l.one=function(t,c,E){var _,k,x,A,B;if(t.DBG&&(t.DBG=B={DBG:t.DBG}),B&&(B.h=E),B&&(B.hp=+new Date),(_=t["#"])||(_=t["#"]=String.random(9)),!(x=n(_))&&(k=t["##"],!(k&&(x=t["@"]||t.get&&_)&&S.check(A=x+k)))){if((t._=function(){}).via=u.leap=c,(x=t["><"])&&typeof x=="string"&&x.slice(0,99).split(",").forEach(function(b){this[b]=1},t._.yo={}),x=t.dam){(x=u.hear[x])&&x(t,c,f),d(_);return}(x=t.ok)&&(t._.near=x["/"]);var E=+new Date;B&&(B.is=E),c.SI=_,d.ed=function(b){_===b&&(d.ed=0,(b=S.s[_])&&(b.via=c,t.get&&(b.it=t)))},f.on("in",u.last=t),B&&(B.hd=+new Date),console.STAT&&console.STAT(E,+new Date-E,t.get?"msg get":t.put?"msg put":"msg"),d(_),A&&d(A),u.leap=u.last=null}},l.c=l.d=0,function(){var t=0,c;u.hash=function(k,x){var A,B,E,b=+new Date;s(k.put,function i(m,j){var D=(B||(B=E=j||"")).slice(0,32768);if(A=String.hash(D,A),B=B.slice(32768),B){v(i,0);return}console.STAT&&console.STAT(b,+new Date-b,"say json+hash"),k._.$put=E,k["##"]=A,u.say(k,x),delete k._.$put},h)};function h(k,x){var A;return x instanceof Object?(Object.keys(x).sort().forEach(_,{to:A={},on:x}),A):x}function _(k){this.to[k]=this.on[k]}u.say=function(k,x){var A;if((A=this)&&(A=A.to)&&A.next&&A.next(k),!k)return!1;var B,E,b,i=k["@"],m=k._||(k._=function(){}),j=k.DBG,D=+new Date;if(m.y=m.y||D,x||j&&(j.y=D),(B=k["#"])||(B=k["#"]=String.random(9)),!c&&d(B),!(E=k["##"])&&p!==k.put&&!m.via&&i){u.hash(k,x);return}if(!x&&i&&(x=(A=S.s[i])&&(A.via||(A=A.it)&&(A=A._)&&A.via)||(A=u.last)&&i===A["#"]&&u.leap),!x&&i)return S.s[i]?void 0:(console.STAT&&console.STAT(+new Date,++t,"total no peer to ack to"),!1);if(i&&!k.put&&!E&&((S.s[i]||"").it||"")["##"])return!1;if(!x&&u.way)return u.way(k);if(j&&(j.yh=+new Date),!(b=m.raw)){u.raw(k,x);return}if(j&&(j.yr=+new Date),!x||!x.id){if(!Object.plain(x||o.peers))return!1;var D=+new Date;o.puff;var O=o.peers,T=Object.keys(x||o.peers||{});console.STAT&&console.STAT(D,+new Date-D,"peer keys"),function U(){var M=+new Date;c=1;var I=m.raw;m.raw=b;for(var P=0,K;P<9&&(K=(T||"")[P++]);)(K=O[K]||(x||"")[K])&&u.say(k,K);m.raw=I,c=0,T=T.slice(P),console.STAT&&console.STAT(M,+new Date-M,"say loop"),T.length&&(v(U,0),i&&d(i))}();return}if(!x.wire&&u.wire&&u.wire(x),B!==x.last){if(x.last=B,x===m.via||(A=m.yo)&&(A[x.url]||A[x.pid]||A[x.id]))return!1;if(console.STAT&&console.STAT(D,((j||m).yp=+new Date)-(m.y||D),"say prep"),!c&&i&&d(i),x.batch){if(x.tail=(A=x.tail||0)+b.length,x.tail<=o.pack){x.batch+=(A?",":"")+b;return}w(x)}x.batch="[";var N=+new Date;setTimeout(function(){console.STAT&&console.STAT(N,+new Date-N,"0ms TO"),w(x)},o.gap),r(b,x),console.STAT&&i===x.SI&&console.STAT(D,+new Date-x.SH,"say ack")}},u.say.c=u.say.d=0,u.raw=function(k,x){if(!k)return"";var A=k._||{},B,E;if(E=A.raw)return E;if(typeof k=="string")return k;var b=k["##"],i=k["@"];if(b&&i){if(!A.via&&n(i+b))return!1;if(E=(S.s[i]||"").it){if(b===E["##"])return!1;E["##"]||(E["##"]=b)}}if(!k.dam&&!k["@"]){var m=0,j=[];E=o.peers;for(var D in E){var O=E[D];if(j.push(O.url||O.pid||O.id),++m>6)break}m>1&&(k["><"]=j.join())}if(k.put&&(E=k.ok)&&(k.ok={"@":(E["@"]||1)-1,"/":E["/"]==k._.near?u.near:E["/"]}),B=A.$put){E={},Object.keys(k).forEach(function(N){E[N]=k[N]}),E.put=":])([:",s(E,function(N,C){if(!N){var U=+new Date;E=C.indexOf('"put":":])([:"'),T(p,C=C.slice(0,E+6)+B+C.slice(E+14)),console.STAT&&console.STAT(U,+new Date-U,"say slice")}});return}s(k,T);function T(N,C){N||(A.raw=C,u.say(k,x))}}}();function w(t){var c=t.batch,h=typeof c=="string";if(h&&(c+="]"),t.batch=t.tail=null,!!c&&!(h?3>c.length:!c.length)){if(!h)try{c=c.length===1?c[0]:JSON.stringify(c)}catch(_){return o.log("DAM JSON stringify error",_)}c&&r(c,t)}}function r(t,c){try{var h=c.wire;c.say?c.say(t):h.send&&h.send(t),u.say.d+=t.length||0,++u.say.c}catch{(c.queue=c.queue||[]).push(t)}}return u.near=0,u.hi=function(t){var c=t.wire,h;if(!c){u.wire(t.length&&{url:t,id:t}||t);return}t.id?o.peers[t.url||t.id]=t:(h=t.id=t.id||t.url||String.random(9),u.say({dam:"?",pid:f.opt.pid},o.peers[h]=t),delete S.s[t.last]),t.met||(u.near++,t.met=+new Date,f.on("hi",t)),h=t.queue,t.queue=[],setTimeout.each(h||[],function(_){r(_,t)},0,9)},u.bye=function(t){t.met&&--u.near,delete t.met,f.on("bye",t);var c=+new Date;c=c-(t.met||c),u.bye.time=((u.bye.time||c)+c)/2},u.hear["!"]=function(t,c){o.log("Error:",t.err)},u.hear["?"]=function(t,c){t.pid&&(c.pid||(c.pid=t.pid),t["@"])||(u.say({dam:"?",pid:o.pid,"@":t["#"]},c),delete S.s[c.last])},u.hear.mob=function(t,c){if(t.peers){var h=Object.keys(t.peers),_=h[Math.random()*h.length>>0];_&&(u.bye(c),u.hi(_))}},f.on("create",function(t){t.opt.pid=t.opt.pid||String.random(9),this.to.next(t),t.on("out",u.say)}),f.on("bye",function(t,c){t=o.peers[t.id||t]||t,this.to.next(t),t.bye?t.bye():(c=t.wire)&&c.close&&c.close(),delete o.peers[t.id],t.wire=null}),f.on("bye",function(t,c){this.to.next(t),(c=console.STAT)&&(c.peers=u.near),(c=t.url)&&setTimeout(function(){},o.lack||9e3)}),f.on("hi",function(t,c){if(this.to.next(t),(c=console.STAT)&&(c.peers=u.near),!o.super){var h=Object.keys(f.next||"");h.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(h,function(_){var k=f.next[_];if(o.super||(k.ask||"")[""]){u.say({get:{"#":_}},t);return}setTimeout.each(Object.keys(k.ask||""),function(x){x&&u.say({"##":String.hash((f.graph[_]||"")[x]),get:{"#":_,".":x}},t)})})}}),u}var p;try{$.exports=y}catch{}})(g,"./mesh"),g(function($){var e=g("./index");e.Mesh=g("./mesh"),e.on("opt",function(s){if(this.to.next(s),s.once)return;var y=s.opt;if(y.WebSocket===!1)return;var p=e.window||{},f=y.WebSocket||p.WebSocket||p.webkitWebSocket||p.mozWebSocket;if(!f)return;y.WebSocket=f;var u=y.mesh=y.mesh||e.Mesh(s);u.wire||y.wire,u.wire=y.wire=o;function o(d){try{if(!d||!d.url)return w&&w(d);var l=d.url.replace(/^http/,"ws"),w=d.wire=new y.WebSocket(l);return w.onclose=function(){S(d),y.mesh.bye(d)},w.onerror=function(r){S(d)},w.onopen=function(){y.mesh.hi(d)},w.onmessage=function(r){r&&y.mesh.hear(r.data||r,d)},w}catch{y.mesh.bye(d)}}setTimeout(function(){!y.super&&s.on("out",{dam:"hi"})},1);var v=2*999;function S(d){clearTimeout(d.defer),y.peers[d.url]&&(n&&d.retry<=0||(d.retry=(d.retry||y.retry+1||60)-(-d.tried+(d.tried=+new Date)<v*4?1:0),d.defer=setTimeout(function l(){if(n&&n.hidden)return setTimeout(l,v);o(d)},v)))}var n=""+a!=typeof document&&document});var a})(g,"./websocket"),g(function($){if(!(typeof Gun>"u")){var e=function(){},a;try{a=(Gun.window||e).localStorage}catch{}a||(Gun.log("Warning: No localStorage exists to persist data to!"),a={setItem:function(y,p){this[y]=p},removeItem:function(y){delete this[y]},getItem:function(y){return this[y]}});var s=JSON.stringifyAsync||function(y,p,f,u){var o;try{p(o,JSON.stringify(y,f,u))}catch(v){p(v)}};Gun.on("create",function y(p){this.to.next(p);var f=p.opt;p.graph;var u=[],o,v,S,n;if(f.localStorage===!1)return;f.prefix=f.file||"gun/";try{o=y[f.prefix]=y[f.prefix]||JSON.parse(S=a.getItem(f.prefix))||{}}catch{o=y[f.prefix]={}}S=(S||"").length,p.on("get",function(l){this.to.next(l);var w=l.get,r,t,c,h;!w||!(r=w["#"])||(t=o[r]||h,t&&(c=w["."])&&!Object.plain(c)&&(t=Gun.state.ify({},c,Gun.state.is(t,c),t[c],r)),Gun.on.get.ack(l,t))}),p.on("put",function(l){this.to.next(l);var w=l.put,r=w["#"],t=w["."],c=l["#"],h=l.ok||"";if(o[r]=Gun.state.ify(o[r],t,w[">"],w[":"],r),n&&S>4999880){p.on("in",{"@":c,err:"localStorage max!"});return}!l["@"]&&(!l._.via||Math.random()<h["@"]/h["/"])&&u.push(c),!v&&(v=setTimeout(d,9+S/333))});function d(){if(!u.length&&((setTimeout.turn||"").s||"").length){setTimeout(d,99);return}var l=u;clearTimeout(v),v=!1,u=[],s(o,function(w,r){try{!w&&a.setItem(f.prefix,r)}catch(t){w=n=t||"localStorage failure"}w&&(Gun.log(w+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),p.on("localStorage:error",{err:w,get:f.prefix,put:o})),S=r.length,setTimeout.each(l,function(t){p.on("in",{"@":t,err:w,ok:0})},0,99)})}})}})(g,"./localStorage")})(),function(){var E;if(""+E!=typeof Gun){var g=function(b){console.warn("Warning! Deprecated internal utility will break in next version:",b)},G=Gun;G.fn=G.fn||{is:function(b){return g("fn"),!!b&&typeof b=="function"}},G.bi=G.bi||{is:function(b){return g("bi"),b instanceof Boolean||typeof b=="boolean"}},G.num=G.num||{is:function(b){return g("num"),!$(b)&&(b-parseFloat(b)+1>=0||b===1/0||b===-1/0)}},G.text=G.text||{is:function(b){return g("text"),typeof b=="string"}},G.text.ify=G.text.ify||function(b){return g("text.ify"),G.text.is(b)?b:typeof JSON<"u"?JSON.stringify(b):b&&b.toString?b.toString():b},G.text.random=G.text.random||function(b,i){g("text.random");var m="";for(b=b||24,i=i||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";b>0;)m+=i.charAt(Math.floor(Math.random()*i.length)),b--;return m},G.text.match=G.text.match||function(b,i){var m,j;return g("text.match"),typeof b!="string"?!1:(typeof i=="string"&&(i={"=":i}),i=i||{},m=i["="]||i["*"]||i[">"]||i["<"],b===m?!0:j!==i["="]?!1:(m=i["*"]||i[">"]||i["<"],b.slice(0,(m||"").length)===m?!0:j!==i["*"]?!1:j!==i[">"]&&j!==i["<"]?b>=i[">"]&&b<=i["<"]:j!==i[">"]&&b>=i[">"]||j!==i["<"]&&b<=i["<"]))},G.text.hash=G.text.hash||function(b,i){if(g("text.hash"),typeof b=="string"){if(i=i||0,!b.length)return i;for(var m=0,j=b.length,D;m<j;++m)D=b.charCodeAt(m),i=(i<<5)-i+D,i|=0;return i}},G.list=G.list||{is:function(b){return g("list"),b instanceof Array}},G.list.slit=G.list.slit||Array.prototype.slice,G.list.sort=G.list.sort||function(b){return g("list.sort"),function(i,m){return!i||!m?0:(i=i[b],m=m[b],i<m?-1:i>m?1:0)}},G.list.map=G.list.map||function(b,i,m){return g("list.map"),A(b,i,m)},G.list.index=1,G.obj=G.boj||{is:function(b){return g("obj"),b?b instanceof Object&&b.constructor===Object||Object.prototype.toString.call(b).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},G.obj.put=G.obj.put||function(b,i,m){return g("obj.put"),(b||{})[i]=m,b},G.obj.has=G.obj.has||function(b,i){return g("obj.has"),b&&Object.prototype.hasOwnProperty.call(b,i)},G.obj.del=G.obj.del||function(b,i){if(g("obj.del"),!!b)return b[i]=null,delete b[i],b},G.obj.as=G.obj.as||function(b,i,m,j){return g("obj.as"),b[i]=b[i]||(j===m?{}:m)},G.obj.ify=G.obj.ify||function(b){if(g("obj.ify"),c(b))return b;try{b=JSON.parse(b)}catch{b={}}return b},function(){var b;function i(m,j){_(this,j)&&b!==this[j]||(this[j]=m)}G.obj.to=G.obj.to||function(m,j){return g("obj.to"),j=j||{},A(m,i,j),j}}(),G.obj.copy=G.obj.copy||function(b){return g("obj.copy"),b&&JSON.parse(JSON.stringify(b))},function(){function b(i,m){var j=this.n,D;if(!(j&&(m===j||c(j)&&_(j,m)))&&D!==m)return!0}G.obj.empty=G.obj.empty||function(i,m){return g("obj.empty"),i?!A(i,b,{n:m}):!0}}(),function(){function b(j,D){if(arguments.length===2){b.r=b.r||{},b.r[j]=D;return}b.r=b.r||[],b.r.push(j)}var i=Object.keys,m;Object.keys=Object.keys||function(j){return m(j,function(D,O,T){T(O)})},G.obj.map=m=G.obj.map||function(j,D,O){g("obj.map");var T,N=0,C,U,M,I,P=typeof D=="function";if(b.r=T,i&&c(j)&&(M=i(j),I=!0),O=O||{},$(j)||M)for(C=(M||j).length;N<C;N++){var K=N+G.list.index;if(P){if(U=I?D.call(O,j[M[N]],M[N],b):D.call(O,j[N],K,b),U!==T)return U}else if(D===j[I?M[N]:N])return M?M[N]:K}else for(N in j)if(P){if(_(j,N)&&(U=O?D.call(O,j[N],N,b):D(j[N],N,b),U!==T))return U}else if(D===j[N])return N;return P?b.r:G.list.index?0:-1}}(),G.time=G.time||{},G.time.is=G.time.is||function(b){return g("time"),b?b instanceof Date:+new Date().getTime()};var r=G.fn.is,$=G.list.is,t=G.obj,c=t.is,_=t.has,A=t.map,e={};e.is=function(b){return g("val.is"),b===E?!1:b===null?!0:b===1/0?!1:y(b)||s(b)||n(b)?!0:e.link.is(b)||!1},e.link=e.rel={_:"#"},function(){e.link.is=function(i){if(g("val.link.is"),i&&i[a]&&!i._&&c(i)){var m={};if(A(i,b,m),m.id)return m.id}return!1};function b(i,m){var j=this;if(j.id)return j.id=!1;if(m==a&&y(i))j.id=i;else return j.id=!1}}(),e.link.ify=function(b){return g("val.link.ify"),x({},a,b)},G.obj.has._=".";var a=e.link._,E,s=G.bi.is,n=G.num.is,y=G.text.is,t=G.obj,c=t.is,x=t.put,A=t.map;G.val=G.val||e;var p={_:"_"};p.soul=function(b,i){return g("node.soul"),b&&b._&&b._[i||o]},p.soul.ify=function(b,i){return g("node.soul.ify"),i=typeof i=="string"?{soul:i}:i||{},b=b||{},b._=b._||{},b._[o]=i.soul||b._[o]||u(),b},p.soul._=e.link._,function(){p.is=function(i,m,j){g("node.is");var D;return c(i)&&(D=p.soul(i))?!A(i,b,{as:j,cb:m,s:D,n:i}):!1};function b(i,m){if(m!==p._){if(!e.is(i))return!0;this.cb&&this.cb.call(this.as,i,m,this.n,this.s)}}}(),function(){p.ify=function(i,m,j){return g("node.ify"),m?typeof m=="string"?m={soul:m}:typeof m=="function"&&(m={map:m}):m={},m.map&&(m.node=m.map.call(j,i,E,m.node||{})),(m.node=p.soul.ify(m.node||{},m))&&A(i,b,{o:m,as:j}),m.node};function b(i,m){var j=this.o,D,O;if(j.map){D=j.map.call(this.as,i,""+m,j.node),O===D?h(j.node,m):j.node&&(j.node[m]=D);return}e.is(i)&&(j.node[m]=i)}}();var t=G.obj,c=t.is,h=t.del,A=t.map,f=G.text,u=f.random,o=p.soul._,E;G.node=G.node||p;var v=G.state;v.lex=function(){return g("state.lex"),v().toString(36).replace(".","")},v.to=function(b,i,m){g("state.to");var j=(b||{})[i];return c(j)&&(j=B(j)),v.ify(m,i,v.is(b,i),j,p.soul(b))},function(){v.map=function(i,m,j){g("state.map");var D,O=c(O=i||m)?O:null;return i=r(i=i||m)?i:null,O&&!i?(m=n(m)?m:v(),O[l]=O[l]||{},A(O,b,{o:O,s:m}),O):(j=j||c(m)?m:D,m=n(m)?m:v(),function(T,N,C,U){if(!i)return b.call({o:C,s:m},T,N),T;i.call(j||this||{},T,N,C,U),!(_(C,N)&&D===C[N])&&b.call({o:C,s:m},T,N)})};function b(i,m){l!==m&&v.ify(this.o,m,this.s)}}();var t=G.obj;t.as;var _=t.has,c=t.is,A=t.map,B=t.copy,S=G.num,n=S.is,d=G.fn,r=d.is,l=p._,E,w={};(function(){w.is=function(m,j,D,O){return g("graph.is"),!m||!c(m)||k(m)?!1:!A(m,b,{cb:j,fn:D,as:O})};function b(m,j){if(!m||j!==p.soul(m)||!p.is(m,this.fn,this.as))return!0;this.cb&&(i.n=m,i.as=this.as,this.cb.call(i.as,m,j,i))}function i(m){m&&p.is(i.n,m,i.as)}})(),function(){w.ify=function(O,T,N){g("graph.ify");var C={path:[],obj:O};return T?typeof T=="string"?T={soul:T}:typeof T=="function"&&(T.map=T):T={},typeof N=="string"&&(T.soul=T.soul||N,N=E),T.soul&&(C.link=e.link.ify(T.soul)),T.shell=(N||{}).shell,T.graph=T.graph||{},T.seen=T.seen||[],T.as=T.as||N,b(T,C),T.root=C.node,T.graph};function b(O,T){var N;return(N=D(O,T))?N:(T.env=O,T.soul=m,p.ify(T.obj,i,T)&&(T.link=T.link||e.link.ify(p.soul(T.node)),T.obj!==O.shell&&(O.graph[e.link.is(T.link)]=T.node)),T)}function i(O,T,N){var C=this,U=C.env,M,I;if(p._===T&&_(O,e.link._))return N._;if(M=j(O,T,N,C,U)){if(T||(C.node=C.node||N||{},_(O,p._)&&p.soul(O)&&(C.node._=B(O._)),C.node=p.soul.ify(C.node,e.link.is(C.link)),C.link=C.link||e.link.ify(p.soul(C.node))),(I=U.map)&&(I.call(U.as||{},O,T,N,C),_(N,T))){if(O=N[T],E===O){h(N,T);return}if(!(M=j(O,T,N,C,U)))return}if(!T)return C.node;if(M===!0)return O;if(I=b(U,{obj:O,path:C.path.concat(T)}),!!I.node)return I.link}}function m(O){var T=this,N=e.link.is(T.link),C=T.env.graph;T.link=T.link||e.link.ify(O),T.link[e.link._]=O,T.node&&T.node[p._]&&(T.node[p._][e.link._]=O),_(C,N)&&(C[O]=C[N],h(C,N))}function j(O,T,N,C,U){var M;if(e.is(O))return!0;if(c(O))return 1;if(M=U.invalid)return O=M.call(U.as||{},O,T,N),j(O,T,N,C,U);U.err="Invalid value at '"+C.path.concat(T).join(".")+"'!",G.list.is(O)&&(U.err+=" Use `.set(item)` instead of an Array.")}function D(O,T){for(var N=O.seen,C=N.length,U;C--;)if(U=N[C],T.obj===U.obj)return U;N.push(T)}}(),w.node=function(b){g("graph.node");var i=p.soul(b);if(i)return x({},i,b)},function(){w.to=function(i,m,j){if(g("graph.to"),!!i){var D={};return j=j||{seen:{}},A(i[m],b,{obj:D,graph:i,opt:j}),D}};function b(i,m){var j,D;if(p._===m){if(k(i,e.link._))return;this.obj[m]=B(i);return}if(!(j=e.link.is(i))){this.obj[m]=i;return}if(D=this.opt.seen[j]){this.obj[m]=D;return}this.obj[m]=this.opt.seen[j]=w.to(this.graph,j,this.opt)}}();var r=G.fn.is,t=G.obj,c=t.is,h=t.del,_=t.has,k=t.empty,x=t.put,A=t.map,B=t.copy,E;G.graph=G.graph||w}}()})(Y);var V=Y.exports,ft=V;const st=at(ft);var Z={exports:{}};Z.exports;(function(J){(function(){function g($,e){return e?it($):$.slice?g[a($)]:function(s,y){$(s={exports:{}}),g[a(y)]=s.exports};function a(s){return s.split("/").slice(-1).toString().replace(".js","")}}var G=J;g(function($){typeof self<"u"&&($.window=self),typeof window<"u"&&($.window=window);var e=$.window||$,a,s=e.SEA||{};(s.window=$.window)&&(s.window.SEA=s);try{a+""!=typeof G&&(G.exports=s)}catch{}$.exports=s})(g,"./root"),g(function($){var e=g("./root");try{e.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(g,"./https"),g(function($){var e;if(e+""==typeof btoa){if(e+""==typeof Buffer)try{z.Buffer=g("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}z.btoa=function(a){return Buffer.from(a,"binary").toString("base64")},z.atob=function(a){return Buffer.from(a,"base64").toString("binary")}}})(g,"./base64"),g(function($){g("./base64");function e(){}Object.assign(e,{from:Array.from}),e.prototype=Object.create(Array.prototype),e.prototype.toString=function(a,s,y){a=a||"utf8",s=s||0;const p=this.length;if(a==="hex"){const f=new Uint8Array(this);return[...Array((y&&y+1||p)-s).keys()].map(u=>f[u+s].toString(16).padStart(2,"0")).join("")}if(a==="utf8")return Array.from({length:(y||p)-s},(f,u)=>String.fromCharCode(this[u+s])).join("");if(a==="base64")return btoa(this)},$.exports=e})(g,"./array"),g(function($){g("./base64");var e=g("./array");function a(...s){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),a.from(...s)}a.prototype=Object.create(Array.prototype),Object.assign(a,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const s=arguments[0];let y;if(typeof s=="string"){const f=arguments[1]||"utf8";if(f==="hex"){const u=s.match(/([\da-fA-F]{2})/g).map(o=>parseInt(o,16));if(!u||!u.length)throw new TypeError("Invalid first argument for type 'hex'.");y=e.from(u)}else if(f==="utf8"||f==="binary"){const u=s.length,o=new Uint16Array(u);Array.from({length:u},(v,S)=>o[S]=s.charCodeAt(S)),y=e.from(o)}else if(f==="base64"){const u=atob(s),o=u.length,v=new Uint8Array(o);Array.from({length:o},(S,n)=>v[n]=u.charCodeAt(n)),y=e.from(v)}else f==="binary"?y=e.from(s):console.info("SafeBuffer.from unknown encoding: "+f);return y}if(s.byteLength,s.byteLength?s.byteLength:s.length){let f;return s instanceof ArrayBuffer&&(f=new Uint8Array(s)),e.from(f||s)}},alloc(s,y=0){return e.from(new Uint8Array(Array.from({length:s},()=>y)))},allocUnsafe(s){return e.from(new Uint8Array(Array.from({length:s})))},concat(s){if(!Array.isArray(s))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return e.from(s.reduce((y,p)=>y.concat(Array.from(p)),[]))}}),a.prototype.from=a.from,a.prototype.toString=e.prototype.toString,$.exports=a})(g,"./buffer"),g(function($){const e=g("./root"),a={Buffer:g("./buffer")};var s={},y;if(JSON.parseAsync=JSON.parseAsync||function(f,u,o){var v;try{u(v,JSON.parse(f,o))}catch(S){u(S)}},JSON.stringifyAsync=JSON.stringifyAsync||function(f,u,o,v){var S;try{u(S,JSON.stringify(f,o,v))}catch(n){u(n)}},a.parse=function(f,u){return new Promise(function(o,v){JSON.parseAsync(f,function(S,n){S?v(S):o(n)},u)})},a.stringify=function(f,u,o){return new Promise(function(v,S){JSON.stringifyAsync(f,function(n,d){n?S(n):v(d)},u,o)})},e.window&&(a.crypto=e.window.crypto||e.window.msCrypto,a.subtle=(a.crypto||s).subtle||(a.crypto||s).webkitSubtle,a.TextEncoder=e.window.TextEncoder,a.TextDecoder=e.window.TextDecoder,a.random=f=>a.Buffer.from(a.crypto.getRandomValues(new Uint8Array(a.Buffer.alloc(f))))),!a.TextDecoder){const{TextEncoder:f,TextDecoder:u}=g((y+""==typeof G?".":"")+"./lib/text-encoding",1);a.TextDecoder=u,a.TextEncoder=f}if(!a.crypto)try{var p=g("crypto",1);Object.assign(a,{crypto:p,random:u=>a.Buffer.from(p.randomBytes(u))});const{Crypto:f}=g("@peculiar/webcrypto",1);a.ossl=a.subtle=new f({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}$.exports=a})(g,"./shim"),g(function($){var e=g("./root"),a=g("./shim"),s={};s.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},s.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},s.ecdh={name:"ECDH",namedCurve:"P-256"},s.jwk=function(y,p){y=y.split(".");var f=y[0],u=y[1],o={kty:"EC",crv:"P-256",x:f,y:u,ext:!0};return o.key_ops=p?["sign"]:["verify"],p&&(o.d=p),o},s.keyToJwk=function(y){return{kty:"oct",k:y.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},s.recall={validity:12*60*60,hook:function(y){return y}},s.check=function(y){return typeof y=="string"&&y.slice(0,4)==="SEA{"},s.parse=async function(p){try{var f=typeof p=="string";return f&&p.slice(0,4)==="SEA{"&&(p=p.slice(3)),f?await a.parse(p):p}catch{}return p},e.opt=s,$.exports=s})(g,"./settings"),g(function($){var e=g("./shim");$.exports=async function(a,s){var y=typeof a=="string"?a:await e.stringify(a),p=await e.subtle.digest({name:s||"SHA-256"},new e.TextEncoder().encode(y));return e.Buffer.from(p)}})(g,"./sha256"),g(function($){const e=g("./shim"),a=e.subtle,s=e.ossl?e.ossl:a,y=p=>s.digest({name:"SHA-1"},new ArrayBuffer(p));$.exports=y})(g,"./sha1"),g(function($){var e=g("./root"),a=g("./shim"),s=g("./settings"),y=g("./sha256"),p;e.work=e.work||(async(f,u,o,v)=>{try{var S=(u||{}).epub||u;if(v=v||{},S instanceof Function&&(o=S,S=p),f=typeof f=="string"?f:await a.stringify(f),(v.name||"").toLowerCase().slice(0,3)==="sha"){var n=a.Buffer.from(await y(f,v.name),"binary").toString(v.encode||"base64");if(o)try{o(n)}catch(r){console.log(r)}return n}S=S||a.random(9);var d=await(a.ossl||a.subtle).importKey("raw",new a.TextEncoder().encode(f),{name:v.name||"PBKDF2"},!1,["deriveBits"]),l=await(a.ossl||a.subtle).deriveBits({name:v.name||"PBKDF2",iterations:v.iterations||s.pbkdf2.iter,salt:new a.TextEncoder().encode(v.salt||S),hash:v.hash||s.pbkdf2.hash},d,v.length||s.pbkdf2.ks*8);f=a.random(f.length);var w=a.Buffer.from(l,"binary").toString(v.encode||"base64");if(o)try{o(w)}catch(r){console.log(r)}return w}catch(r){if(console.log(r),e.err=r,e.throw)throw r;o&&o();return}}),$.exports=e.work})(g,"./work"),g(function($){var e=g("./root"),a=g("./shim");g("./settings"),e.name=e.name||(async(s,y)=>{try{if(s)try{s()}catch(p){console.log(p)}return}catch(p){if(console.log(p),e.err=p,e.throw)throw p;s&&s();return}}),e.pair=e.pair||(async(s,y)=>{try{var p=a.ossl||a.subtle,f=await a.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async v=>{var S={};S.priv=(await a.subtle.exportKey("jwk",v.privateKey)).d;var n=await a.subtle.exportKey("jwk",v.publicKey);return S.pub=n.x+"."+n.y,S});try{var u=await p.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async v=>{var S={};S.epriv=(await p.exportKey("jwk",v.privateKey)).d;var n=await p.exportKey("jwk",v.publicKey);return S.epub=n.x+"."+n.y,S})}catch(v){if(e.window)throw v;if(v=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw v}u=u||{};var o={pub:f.pub,priv:f.priv,epub:u.epub,epriv:u.epriv};if(s)try{s(o)}catch(v){console.log(v)}return o}catch(v){if(console.log(v),e.err=v,e.throw)throw v;s&&s();return}}),$.exports=e.pair})(g,"./pair"),g(function($){var e=g("./root"),a=g("./shim"),s=g("./settings"),y=g("./sha256"),p;e.sign=e.sign||(async(f,u,o,v)=>{try{if(v=v||{},!(u||v).priv){if(!e.I)throw"No signing key.";u=await e.I(null,{what:f,how:"sign",why:v.why})}if(p===f)throw"`undefined` not allowed.";var S=await s.parse(f),n=v.check=v.check||S;if(e.verify&&(e.opt.check(n)||n&&n.s&&n.m)&&p!==await e.verify(n,u)){var c=await s.parse(n);if(v.raw||(c="SEA"+await a.stringify(c)),o)try{o(c)}catch(_){console.log(_)}return c}var d=u.pub,l=u.priv,w=s.jwk(d,l),r=await y(S),t=await(a.ossl||a.subtle).importKey("jwk",w,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(h=>(a.ossl||a.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},h,new Uint8Array(r))),c={m:S,s:a.Buffer.from(t,"binary").toString(v.encode||"base64")};if(v.raw||(c="SEA"+await a.stringify(c)),o)try{o(c)}catch(h){console.log(h)}return c}catch(h){if(console.log(h),e.err=h,e.throw)throw h;o&&o();return}}),$.exports=e.sign})(g,"./sign"),g(function($){var e=g("./root"),a=g("./shim"),s=g("./settings"),y=g("./sha256"),p;e.verify=e.verify||(async(o,v,S,n)=>{try{var d=await s.parse(o);if(v===!1){var l=await s.parse(d.m);if(S)try{S(l)}catch(A){console.log(A)}return l}n=n||{};var w=v.pub||v,r=e.opt.slow_leak?await e.opt.slow_leak(w):await(a.ossl||a.subtle).importKey("jwk",s.jwk(w),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),t=await y(d.m),c,h,_,k;try{if(c=a.Buffer.from(d.s,n.encode||"base64"),h=new Uint8Array(c),_=await(a.ossl||a.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},r,h,new Uint8Array(t)),!_)throw"Signature did not match."}catch{if(e.opt.fallback)return await e.opt.fall_verify(o,v,S,n)}var x=_?await s.parse(d.m):p;if(S)try{S(x)}catch(A){console.log(A)}return x}catch(A){if(console.log(A),e.err=A,e.throw)throw A;S&&S();return}}),$.exports=e.verify;var f={};e.opt.slow_leak=o=>{if(f[o])return f[o];var v=s.jwk(o);return f[o]=(a.ossl||a.subtle).importKey("jwk",v,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),f[o]};var u=e.opt;e.opt.fall_verify=async function(o,v,S,n,d){if(d===e.opt.fallback)throw"Signature did not match";d=d||1;var l=o||"";o=e.opt.unpack(o)||o;var w=await s.parse(o),r=v.pub||v,t=await e.opt.slow_leak(r),c=d<=e.opt.fallback?a.Buffer.from(await a.subtle.digest({name:"SHA-256"},new a.TextEncoder().encode(await s.parse(w.m)))):await y(w.m),h,_,k;try{if(h=a.Buffer.from(w.s,n.encode||"base64"),_=new Uint8Array(h),k=await(a.ossl||a.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},t,_,new Uint8Array(c)),!k)throw"Signature did not match."}catch{try{h=a.Buffer.from(w.s,"utf8"),_=new Uint8Array(h),k=await(a.ossl||a.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},t,_,new Uint8Array(c))}catch{if(!k)throw"Signature did not match."}}var x=k?await s.parse(w.m):p;if(u.fall_soul=l["#"],u.fall_key=l["."],u.fall_val=o,u.fall_state=l[">"],S)try{S(x)}catch(A){console.log(A)}return x},e.opt.fallback=2})(g,"./verify"),g(function($){var e=g("./shim"),a=g("./settings"),s=g("./sha256");const y=async(p,f,u)=>{const o=p+(f||e.random(8)).toString("utf8"),v=e.Buffer.from(await s(o),"binary"),S=a.keyToJwk(v);return await e.subtle.importKey("jwk",S,{name:"AES-GCM"},!1,["encrypt","decrypt"])};$.exports=y})(g,"./aeskey"),g(function($){var e=g("./root"),a=g("./shim");g("./settings");var s=g("./aeskey"),y;e.encrypt=e.encrypt||(async(p,f,u,o)=>{try{o=o||{};var v=(f||o).epriv||f;if(y===p)throw"`undefined` not allowed.";if(!v){if(!e.I)throw"No encryption key.";f=await e.I(null,{what:p,how:"encrypt",why:o.why}),v=f.epriv||f}var S=typeof p=="string"?p:await a.stringify(p),n={s:a.random(9),iv:a.random(15)},d=await s(v,n.s,o).then(w=>a.subtle.encrypt({name:o.name||"AES-GCM",iv:new Uint8Array(n.iv)},w,new a.TextEncoder().encode(S))),l={ct:a.Buffer.from(d,"binary").toString(o.encode||"base64"),iv:n.iv.toString(o.encode||"base64"),s:n.s.toString(o.encode||"base64")};if(o.raw||(l="SEA"+await a.stringify(l)),u)try{u(l)}catch(w){console.log(w)}return l}catch(w){if(console.log(w),e.err=w,e.throw)throw w;u&&u();return}}),$.exports=e.encrypt})(g,"./encrypt"),g(function($){var e=g("./root"),a=g("./shim"),s=g("./settings"),y=g("./aeskey");e.decrypt=e.decrypt||(async(p,f,u,o)=>{try{o=o||{};var v=(f||o).epriv||f;if(!v){if(!e.I)throw"No decryption key.";f=await e.I(null,{what:p,how:"decrypt",why:o.why}),v=f.epriv||f}var S=await s.parse(p),n,d,l;try{n=a.Buffer.from(S.s,o.encode||"base64"),d=a.Buffer.from(S.iv,o.encode||"base64"),l=a.Buffer.from(S.ct,o.encode||"base64");var w=await y(v,n,o).then(t=>a.subtle.decrypt({name:o.name||"AES-GCM",iv:new Uint8Array(d),tagLength:128},t,new Uint8Array(l)))}catch{if(o.encode==="utf8")throw"Could not decrypt";if(e.opt.fallback)return o.encode="utf8",await e.decrypt(p,f,u,o)}var r=await s.parse(new a.TextDecoder("utf8").decode(w));if(u)try{u(r)}catch(t){console.log(t)}return r}catch(t){if(console.log(t),e.err=t,e.throw)throw t;u&&u();return}}),$.exports=e.decrypt})(g,"./decrypt"),g(function($){var e=g("./root"),a=g("./shim");g("./settings"),e.secret=e.secret||(async(y,p,f,u)=>{try{if(u=u||{},!p||!p.epriv||!p.epub){if(!e.I)throw"No secret mix.";p=await e.I(null,{what:y,how:"secret",why:u.why})}var o=y.epub||y,v=p.epub,S=p.epriv,n=a.ossl||a.subtle,d=s(o),l=Object.assign({public:await n.importKey(...d,!0,[])},{name:"ECDH",namedCurve:"P-256"}),w=s(v,S),r=await n.importKey(...w,!1,["deriveBits"]).then(async c=>{var h=await n.deriveBits(l,c,256),_=new Uint8Array(h),k=await n.importKey("raw",_,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return n.exportKey("jwk",k).then(({k:x})=>x)}),t=r;if(f)try{f(t)}catch(c){console.log(c)}return t}catch(c){if(console.log(c),e.err=c,e.throw)throw c;f&&f();return}});var s=(y,p)=>{var[f,u]=y.split("."),o=p?{d:p}:{};return["jwk",Object.assign(o,{x:f,y:u,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};$.exports=e.secret})(g,"./secret"),g(function($){var e=g("./root");e.certify=e.certify||(async(a,s={},y,p,f={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),a=(()=>{var t=[];if(a){if((typeof a=="string"||Array.isArray(a))&&a.indexOf("*")>-1)return"*";if(typeof a=="string")return a;if(Array.isArray(a)){if(a.length===1&&a[0])return typeof a[0]=="object"&&a[0].pub?a[0].pub:typeof a[0]=="string"?a[0]:null;a.map(c=>{typeof c=="string"?t.push(c):typeof c=="object"&&c.pub&&t.push(c.pub)})}return typeof a=="object"&&a.pub?a.pub:t.length>0?t:null}})(),!a)return console.log("No certificant found.");const o=f.expiry&&(typeof f.expiry=="number"||typeof f.expiry=="string")?parseFloat(f.expiry):null,v=(s||{}).read?s.read:null,S=(s||{}).write?s.write:typeof s=="string"||Array.isArray(s)||s["+"]||s["#"]||s["."]||s["="]||s["*"]||s[">"]||s["<"]?s:null,n=(f||{}).block||(f||{}).blacklist||(f||{}).ban||{},d=n.read&&(typeof n.read=="string"||(n.read||{})["#"])?n.read:null,l=typeof n=="string"?n:n.write&&(typeof n.write=="string"||n.write["#"])?n.write:null;if(!v&&!S)return console.log("No policy found.");const w=JSON.stringify({c:a,...o?{e:o}:{},...v?{r:v}:{},...S?{w:S}:{},...d?{rb:d}:{},...l?{wb:l}:{}});var u=await e.sign(w,y,null,{raw:1});if(f.raw||(u="SEA"+JSON.stringify(u)),p)try{p(u)}catch(t){console.log(t)}return u}catch(o){if(e.err=o,e.throw)throw o;p&&p();return}}),$.exports=e.certify})(g,"./certify"),g(function($){var e=g("./shim"),a=g("./root");a.work=g("./work"),a.sign=g("./sign"),a.verify=g("./verify"),a.encrypt=g("./encrypt"),a.decrypt=g("./decrypt"),a.certify=g("./certify"),a.random=a.random||e.random,a.Buffer=a.Buffer||g("./buffer"),a.keyid=a.keyid||(async s=>{try{const y=e.Buffer.concat(s.replace(/-/g,"+").replace(/_/g,"/").split(".").map(o=>e.Buffer.from(o,"base64"))),p=e.Buffer.concat([e.Buffer.from([153,y.length/256,y.length%256]),y]),f=await sha1hash(p),u=e.Buffer.from(f,"binary");return u.toString("hex",u.length-8)}catch(y){throw console.log(y),y}}),((a.window||{}).GUN||{}).SEA=a,$.exports=a})(g,"./sea"),g(function($){var e=g("./sea"),a,s;e.window?a=e.window.GUN||{chain:{}}:a=g((s+""==typeof G?".":"")+"./gun",1),e.GUN=a;function y(f){this._={$:this}}y.prototype=function(){function f(){}return f.prototype=a.chain,new f}(),y.prototype.constructor=y,a.chain.user=function(f){var u=this,v=u.back(-1),o;if(f)return f=e.opt.pub((f._||"")["#"])||f,v.get("~"+f);if(o=v.back("user"))return o;var v=v._,S=v,n=S.opt.uuid||p;return(S=(o=S.user=u.chain(new y))._).opt={},S.opt.uuid=function(d){var l=n(),w=v.user;return!w||!(w=w.is)||!(w=w.pub)||(l="~"+w+"/"+l,d&&d.call&&d(null,l)),l},o};function p(){return a.state().toString(36).replace(".","")}a.User=y,y.GUN=a,y.SEA=a.SEA=e,$.exports=y})(g,"./user"),g(function($){var e,a=""+e!=typeof GUN?GUN||{chain:{}}:g((""+e==typeof G?".":"")+"./gun",1);a.chain.then=function(s,y){var p=this,f=new Promise(function(u,o){p.once(u,y)});return s?f.then(s):f}})(g,"./then"),g(function($){var e=g("./user"),a=e.SEA,s=e.GUN,y=function(){};e.prototype.create=function(...p){var f=typeof p[0]=="object"&&(p[0].pub||p[0].epub)?p[0]:typeof p[1]=="object"&&(p[1].pub||p[1].epub)?p[1]:null,u=f&&(f.pub||f.epub)?f.pub:typeof p[0]=="string"?p[0]:null,o=f&&(f.pub||f.epub)?f:u&&typeof p[1]=="string"?p[1]:null,v=p.filter(t=>typeof t=="function")[0]||null,S=p&&p.length>1&&typeof p[p.length-1]=="object"?p[p.length-1]:{},n=this,d=n._,l=n.back(-1);if(v=v||y,S=S||{},S.check!==!1){var w;if(u||(w="No user."),(o||"").length<8&&(w="Password too short!"),w)return v({err:s.log(w)}),n}if(d.ing)return(v||y)({err:s.log("User is already being created or authenticated!"),wait:!0}),n;d.ing=!0;var r={};return r.a=function(t){if(r.pubs=t,t&&!S.already){var c={err:s.log("User already created!")};d.ing=!1,(v||y)(c),n.leave();return}r.salt=String.random(64),a.work(o,r.salt,r.b)},r.b=function(t){r.proof=t,f?r.c(f):a.pair(r.c)},r.c=function(t){var c;r.pair=t||{},(c=d.root.user)&&(c._.sea=t,c.is={pub:t.pub,epub:t.epub,alias:u}),r.data={pub:t.pub},r.d()},r.d=function(){r.data.alias=u,r.e()},r.e=function(){r.data.epub=r.pair.epub,a.encrypt({priv:r.pair.priv,epriv:r.pair.epriv},r.proof,r.f,{raw:1})},r.f=function(t){r.data.auth=JSON.stringify({ek:t,s:r.salt}),r.g(r.data.auth)},r.g=function(t){var c;r.data.auth=r.data.auth||t,l.get(c="~"+r.pair.pub).put(r.data).on(r.h);var h={};h[c]={"#":c},l.get("~@"+u).put(h).get(c).on(r.i)},r.h=function(t,c,h,_){_.off(),r.h.ok=1,r.i()},r.i=function(t,c,h,_){_&&(r.i.ok=1,_.off()),!(!r.h.ok||!r.i.ok)&&(d.ing=!1,v({ok:0,pub:r.pair.pub}),y===v&&(f?n.auth(f):n.auth(u,o)))},l.get("~@"+u).once(r.a),n},e.prototype.leave=function(p,f){var u=this,o=u.back(-1)._.user;if(o&&(delete o.is,delete o._.is,delete o._.sea),a.window)try{var v={};v=a.window.sessionStorage,delete v.recall,delete v.pair}catch{}return u}})(g,"./create"),g(function($){var e=g("./user"),a=e.SEA,s=e.GUN,y=function(){};e.prototype.auth=function(...f){var u=typeof f[0]=="object"&&(f[0].pub||f[0].epub)?f[0]:typeof f[1]=="object"&&(f[1].pub||f[1].epub)?f[1]:null,o=!u&&typeof f[0]=="string"?f[0]:null,v=(o||u&&!(u.priv&&u.epriv))&&typeof f[1]=="string"?f[1]:null,S=f.filter(h=>typeof h=="function")[0]||null,n=f&&f.length>1&&typeof f[f.length-1]=="object"?f[f.length-1]:{},d=this,l=d._,w=d.back(-1);if(l.ing)return(S||y)({err:s.log("User is already being created or authenticated!"),wait:!0}),d;l.ing=!0;var r={},t,c=9;return r.a=function(h){if(!h)return r.b();if(!h.pub){var _=[];return Object.keys(h).forEach(function(k){k!="_"&&_.push(h[k])}),r.b(_)}if(r.name)return r.f(h);r.c((r.data=h).auth)},r.b=function(h){var _=(r.list=(r.list||[]).concat(h||[])).shift();if(t===_){if(r.name)return r.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(o&&c--){w.get("~@"+o).once(r.a);return}return r.err("Wrong user or password.")}w.get(_).once(r.a)},r.c=function(h){if(t===h)return r.b();if(typeof h=="string")return r.c(p(h));a.work(v,(r.auth=h).s,r.d,r.enc)},r.d=function(h){a.decrypt(r.auth.ek,h,r.e,r.enc)},r.e=function(h){if(t===h)return r.enc?(r.enc=null,r.b()):(r.enc={encode:"utf8"},r.c(r.auth));r.half=h,r.f(r.data)},r.f=function(h){var _=r.half||{},k=r.data||{};r.g(r.lol={pub:h.pub||k.pub,epub:h.epub||k.epub,priv:h.priv||_.priv,epriv:h.epriv||_.epriv})},r.g=function(h){if(!h||!h.pub||!h.epub)return r.b();r.pair=h;var _=w._.user,k=_._;k.tag;var x=k.opt;k=_._=w.get("~"+h.pub)._,k.opt=x,_.is={pub:h.pub,epub:h.epub,alias:o||h.pub},k.sea=r.pair,l.ing=!1;try{v&&t==(p(l.root.graph["~"+h.pub].auth)||"")[":"]&&(n.shuffle=n.change=v)}catch{}if(n.change?r.z():(S||y)(k),a.window&&(d.back("user")._.opt||n).remember)try{var A={};A=a.window.sessionStorage,A.recall=!0,A.pair=JSON.stringify(h)}catch{}try{w._.tag.auth?w._.on("auth",k):setTimeout(function(){w._.on("auth",k)},1)}catch(B){s.log("Your 'auth' callback crashed with:",B)}},r.h=function(h){if(!h)return r.b();if(o=h.alias,o||(o=h.alias="~"+u.pub),!h.auth)return r.g(u);u=null,r.c((r.data=h).auth)},r.z=function(){r.salt=String.random(64),a.work(n.change,r.salt,r.y)},r.y=function(h){a.encrypt({priv:r.pair.priv,epriv:r.pair.epriv},h,r.x,{raw:1})},r.x=function(h){r.w(JSON.stringify({ek:h,s:r.salt}))},r.w=function(h){if(n.shuffle){console.log("migrate core account from UTF8 & shuffle");var _={};Object.keys(r.data).forEach(function(k){_[k]=r.data[k]}),delete _._,_.auth=h,w.get("~"+r.pair.pub).put(_)}w.get("~"+r.pair.pub).get("auth").put(h,S||y)},r.err=function(h){var _={err:s.log(h||"User cannot be found!")};l.ing=!1,(S||y)(_)},r.plugin=function(h){if(!(r.name=h))return r.err();var _=[h];h[0]!=="~"&&(_[1]="~"+h,_[2]="~@"+h),r.b(_)},u?u.priv&&u.epriv?r.g(u):w.get("~"+u.pub).once(r.h):o?w.get("~@"+o).once(r.a):!o&&!v&&a.name(r.plugin),d};function p(f){if(typeof f!="string")return f;try{f=JSON.parse(f)}catch{f={}}return f}})(g,"./auth"),g(function($){var e=g("./user"),a=e.SEA;e.GUN,e.prototype.recall=function(s,y){var p=this,f=p.back(-1);if(s=s||{},s&&s.sessionStorage){if(a.window)try{var u={};u=a.window.sessionStorage,u&&(f._.opt.remember=!0,(p.back("user")._.opt||s).remember=!0,(u.recall||u.pair)&&f.user().auth(JSON.parse(u.pair),y))}catch{}return p}return p}})(g,"./recall"),g(function($){var e=g("./user"),a=e.SEA,s=e.GUN,y=function(){};e.prototype.pair=function(){var p=this,f;try{f=new Proxy({DANGER:""},{get:function(u,o,v){if(!(!p.is||!(p._||"").sea))return p._.sea[o]}})}catch{}return f},e.prototype.delete=async function(p,f,u){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var o=this;o.back(-1);var v=o.back("user");try{v.auth(p,f,function(S){var n=(v.is||{}).pub;v.map().once(function(){this.put(null)}),v.leave(),(u||y)({ok:0})})}catch(S){s.log("User.delete failed! Error:",S)}return o},e.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const p=this.back(-1);try{return await authRecall(p),p._.user._}catch{const u="No session!";throw s.log(u),{err:u}}},e.prototype.trust=async function(p){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),s.is(p)&&p.get("pub").get((f,u)=>{console.log(f,u)}),p.get("trust").get(path).put(theirPubkey)},e.prototype.grant=function(p,f){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,o=u.back(-1).user(),v=o._.sea,S="";return u.back(function(n){n.is||(S+=n.get||"")}),async function(){var n,d=await o.get("grant").get(v.pub).get(S).then();d=await a.decrypt(d,v),d||(d=a.random(16).toString(),n=await a.encrypt(d,v),o.get("grant").get(v.pub).get(S).put(n));var l=p.get("pub").then(),w=p.get("epub").then();l=await l,w=await w;var r=await a.secret(w,v);n=await a.encrypt(d,r),o.get("grant").get(l).get(S).put(n,f)}(),u},e.prototype.secret=function(p,f){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,o=u.back(-1).user(),v=o.pair(),S="";return u.back(function(n){n.is||(S+=n.get||"")}),async function(){var n,d=await o.get("trust").get(v.pub).get(S).then();d=await a.decrypt(d,v),d||(d=a.random(16).toString(),n=await a.encrypt(d,v),o.get("trust").get(v.pub).get(S).put(n)),n=await a.encrypt(p,d),u.put(n,f)}(),u},$.exports=e})(g,"./share"),g(function($){var e=g("./sea"),a=g("./settings"),s,y=(e.window||"").GUN||g((""+s==typeof G?".":"")+"./gun",1);y.on("opt",function(n){n.sea||(n.sea={own:{}},n.on("put",p,n)),this.to.next(n)});function p(n){var d=this,l=d.as,w=n.put,r=w["#"],t=w["."],c=w[":"],h=w[">"],_=n["#"],k;if(!(!r||!t)){if((n._||"").faith&&(l.opt||"").faith&&typeof n._=="function"){e.opt.pack(w,function(A){e.verify(A,!1,function(B){w["="]=e.opt.unpack(B),d.to.next(n)})});return}var x=function(A){l.on("in",{"@":_,err:n.err=A})};if((n._||"").DBG&&((n._||"").DBG.c=+new Date),0<=r.indexOf("<?")&&(k=parseFloat(r.split("<?")[1]||""),k&&h<y.state()-k*1e3)){(k=n._)&&k.stun&&k.stun--;return}if(r==="~@"){p.alias(d,n,c,t,r,l,x);return}if(r.slice(0,2)==="~@"){p.pubs(d,n,c,t,r,l,x);return}if(k=e.opt.pub(r)){p.pub(d,n,c,t,r,l,x,l.user||"",k);return}if(0<=r.indexOf("#")){p.hash(d,n,c,t,r,l,x);return}p.any(d,n,c,t,r,l,x,l.user||"")}}p.hash=function(n,d,l,w,r,t,c){e.work(l,null,function(h){function _(k){let x="";for(let A=0;A<k.length;A++)x+=A-1&1?"":String.fromCharCode(parseInt(k.substring(A-1,A+1),16));return btoa(x)}if(h&&h===w.split("#").slice(-1)[0])return n.to.next(d);if(h&&h===_(w.split("#").slice(-1)[0]))return n.to.next(d);c("Data hash not same as hash!")},{name:"SHA-256"})},p.alias=function(n,d,l,w,r,t,c){if(!l)return c("Data must exist!");if("~@"+w===u(l))return n.to.next(d);c("Alias not same!")},p.pubs=function(n,d,l,w,r,t,c){if(!l)return c("Alias must exist!");if(w===u(l))return n.to.next(d);c("Alias not same!")},p.pub=async function(n,d,l,w,r,t,c,h,_){var k;const x=await a.parse(l)||{},A=(B,E,b)=>{if(B.m&&B.s&&E&&_)return e.verify(B,_,i=>{if(s!==i&&s!==i.e&&d.put[">"]&&d.put[">"]>parseFloat(i.e))return c("Certificate expired.");if(s!==i&&i.c&&i.w&&(i.c===E||i.c.indexOf("*")>-1)){let j=r.indexOf("/")>-1?r.replace(r.substring(0,r.indexOf("/")+1),""):"";String.match=String.match||y.text.match;const D=Array.isArray(i.w)?i.w:typeof i.w=="object"||typeof i.w=="string"?[i.w]:[];for(const O of D)if(String.match(j,O["#"])&&String.match(w,O["."])||!O["."]&&String.match(j,O["#"])||!O["#"]&&String.match(w,O["."])||String.match(j?j+"/"+w:w,O["#"]||O)){if(O["+"]&&O["+"].indexOf("*")>-1&&j&&j.indexOf(E)==-1&&w.indexOf(E)==-1)return c(`Path "${j}" or key "${w}" must contain string "${E}".`);if(i.wb&&(typeof i.wb=="string"||(i.wb||{})["#"])){var m=n.as.root.$.back(-1);return typeof i.wb=="string"&&i.wb.slice(0,1)!=="~"&&(m=m.get("~"+_)),m.get(i.wb).get(E).once(T=>T&&(T===1||T===!0)?c(`Certificant ${E} blocked.`):b(i))}return b(i)}return c("Certificate verification fail.")}})};if(w==="pub"&&"~"+_===r)return l===_?n.to.next(d):c("Account not same!");if((k=h.is)&&k.pub&&!x["*"]&&!x["+"]&&(_===k.pub||_!==k.pub&&((d._.msg||{}).opt||{}).cert)){e.opt.pack(d.put,B=>{e.sign(B,h._.sea,async function(E){if(s===E)return c(e.err||"Signature fail.");if(d.put[":"]={":":k=e.opt.unpack(E.m),"~":E.s},d.put["="]=k,_===h.is.pub){(k=u(l))&&((t.sea.own[k]=t.sea.own[k]||{})[_]=1),JSON.stringifyAsync(d.put[":"],function(b,i){return b?c(b||"Stringify error."):(d.put[":"]=i,n.to.next(d))});return}if(_!==h.is.pub&&((d._.msg||{}).opt||{}).cert){const b=await a.parse(d._.msg.opt.cert);b&&b.m&&b.s&&A(b,h.is.pub,i=>{d.put[":"]["+"]=b,d.put[":"]["*"]=h.is.pub,JSON.stringifyAsync(d.put[":"],function(m,j){return m?c(m||"Stringify error."):(d.put[":"]=j,n.to.next(d))})})}},{raw:1})});return}e.opt.pack(d.put,B=>{e.verify(B,x["*"]||_,function(E){var b;if(E=e.opt.unpack(E),s===E)return c("Unverified data.");if((b=u(E))&&_===e.opt.pub(b)&&((t.sea.own[b]=t.sea.own[b]||{})[_]=1),x["+"]&&x["+"].m&&x["+"].s&&x["*"])A(x["+"],x["*"],i=>(d.put["="]=E,n.to.next(d)));else return d.put["="]=E,n.to.next(d)})})},p.any=function(n,d,l,w,r,t,c,h){if(t.opt.secure)return c("Soul missing public key at '"+w+"'.");t.on("secure",function(_){if(this.off(),!t.opt.secure)return n.to.next(_);c("Data cannot be changed.")}).on.on("secure",d)};var f=y.valid,u=function(n,d){return typeof(d=f(n))=="string"&&d};(y.state||"").ify;var o=/[^\w_-]/;e.opt.pub=function(n){if(n&&(n=n.split("~"),!(!n||!(n=n[1]))&&(n=n.split(o).slice(0,2),!(!n||n.length!=2)&&(n[0]||"")[0]!=="@")))return n=n.slice(0,2).join("."),n},e.opt.stringy=function(n){},e.opt.pack=function(n,d,l,w,r){var t,c;if(e.opt.check(n))return d(n);n&&n["#"]&&n["."]&&n[">"]&&(t=n[":"],c=1),JSON.parseAsync(c?t:n,function(h,_){var k=s!==(_||"")[":"]&&(_||"")["~"];if(!k){d(n);return}d({m:{"#":r||n["#"],".":l||n["."],":":(_||"")[":"],">":n[">"]||y.state.is(w,l)},s:k})})};var v=e.opt;e.opt.unpack=function(n,d,l){var w;if(s!==n){if(n&&s!==(w=n[":"]))return w;if(d=d||v.fall_key,!l&&v.fall_val&&(l={},l[d]=v.fall_val),!(!d||!l)){if(n===l[d]||!e.opt.check(l[d]))return n;var r=l&&l._&&l._["#"]||v.fall_soul,t=y.state.is(l,d)||v.fall_state;if(n&&n.length===4&&r===n[0]&&d===n[1]&&S(t)===S(n[3]))return n[2];if(t<e.opt.shuffle_attack)return n}}},e.opt.shuffle_attack=15463296e5;var S=Math.floor})(g,"./index")})()})(Z);Z.exports;var ct={exports:{}},nt={},rt;function lt(){if(rt)return nt;rt=1;var J={},g=typeof window<"u"?window.Gun:V,G;g.on("opt",function(e){$(e),this.to.next(e)});function $(e){if(e.axe)return;var a=e.opt;if(a.peers,a.axe===!1||typeof process<"u"&&""+(J||"").AXE=="false")return;g.log.once("AXE","AXE relay enabled!");var s=e.axe={},y=a.mesh=a.mesh||g.Mesh(e),p=e.dup;y.way=function(l){if(l){if(l.get)return f(l);l.put||u(l)}};function f(l){if(l){var w=(l._||"").via,r;if(!w||!w.id||!(r=o(l)._))return u(l);r.asked=+new Date,f.turn(l,r.route,0)}}f.turn=function(l,w,r){var t=l["#"],c=p.s[t],h;if(!(!t||!c)&&(clearTimeout(c.lack),!(c.ack&&(t=c["##"])&&l["##"]===t))){if(h=Object.maps(w||a.peers).slice(r=r||0),!h.length){if(!w)return;f.turn(l,G,0);return}setTimeout.each(h,function(_){var k=a.peers[_];if(r++,!k||!k.wire){w&&w.delete(_);return}if(y.say(l,k)!==!1&&r%3==0)return 1},function(){c["##"]=l["##"],c.lack=setTimeout(function(){f.turn(l,w,r)},25)},3)}};function u(l){y.say(l,a.peers)}function o(l){var w="",r,t,c;if(!l||!l.get)return w;typeof(r=l.get["#"])=="string"&&(w=e.$.get(r)),typeof(c=l.get["."])=="string"?t=c:t="";var h=(l._||"").via,_=h.sub||(h.sub=new Object.Map);return(_.get(r)||_.set(r,c=new Object.Map)&&c).set(t,1),h.id&&w._&&(w._.route||(w._.route=new Object.Map)).set(h.id,h),w}function v(l){return(l=l||"")["="]||l["*"]||l[">"]||l}e.on("in",function(l){var w=this.to,r;if((r=l["@"])&&(r=p.s[r])){if(r.ack=(r.ack||0)+1,r.it&&r.it.get&&l.put){var t=r.it.get||"",c=o(r.it)._,h=(r.it._||"").via||"",_;if(h&&c&&(h.id&&(c.route||(c.route=new Object.Map)).set(h.id,h),_=h.sub||(h.sub=new Object.Map),c&&(_.get(v(t["#"]))||_.set(v(t["#"]),_=new Object.Map)&&_).set(v(t["."]),1),h=(l._||"").via||"",h&&(h.id&&(c.route||(c.route=new Object.Map)).set(h.id,h),_=h.sub||(h.sub=new Object.Map),c))){var k=v(t["#"]),x=_.get(k),A=v(t["."]);A?(x||_.set(k,x=new Object.Map)&&x).set(A,1):x||(_.set(k,x=new Object.Map),x.set("",1))}}if(r=r.back){setTimeout.each(Object.keys(r),function(B){w.next({"#":l["#"],"@":B,ok:l.ok})});return}}w.next(l)}),e.on("create",function(l){this.to.next(l),l.on("put",function(w){var r=this;r.as;var t=w.put,c=t["#"],h=t["."],_=t[":"],k=t[">"];if(r.to.next(w),!w["@"]&&!(!c||!h)){var x=l.$.get(c)._,A=(x||"").route;if(A){if(x.skip&&x.skip.has==h){x.skip.now=w["#"];return}(x.skip={now:w["#"],has:h}).to=setTimeout(function(){setTimeout.each(Object.maps(A),function(B){var E,D,b=x.skip||"";if(x.skip=null,!!(E=A.get(B))){if(!E.wire){A.delete(B);return}var i=(E.sub||(E.sub=new Object.Map)).get(c);if(i&&!(!i.get(h)&&!i.get(""))){var m=E.put||(E.put={}),j=l.graph[c],D;j&&G!==(D=j[h])&&(k=d(j,h),_=D),m[c]=n(m[c],h,k,_,c),D=p.track(E.next=E.next||String.random(9)),(D.back||(D.back={}))[""+(b.now||w["#"])]=1,!E.to&&(E.to=setTimeout(function(){S(E)},a.gap))}}})},9)}}})});function S(l){var w={"#":l.next,put:l.put,ok:{"@":3,"/":y.near}};l.next=l.put=l.to=null,y.say(w,l)}var n=g.state.ify,d=g.state.is;(function(){s.up={};var l=y.hear["?"];y.hear["?"]=function(w,r){var t;if(l(w,r),!!r.pid){if(r.pid===a.pid){y.bye(r);return}if(t=s.up[r.pid]){if(t===r)return;a.pid>r.pid&&(t=r,r=s.up[t.pid]),t.url=t.url||r.url,y.bye(r),s.up[t.pid]=t;return}r.url&&(s.up[r.pid]=r,s.stay&&s.stay())}},y.hear.opt=function(w,r){if(!w.ok){var t=w.opt;t&&(t=t.peers,!(!t||typeof t!="string")&&(99<=Object.keys(s.up).length||(y.hi({id:t,url:t,retry:9}),r&&y.say({dam:"opt",ok:1,"@":w["#"]},r))))}},s.stay=function(){clearTimeout(s.stay.to),s.stay.to=setTimeout(function(w,r){(w=e.stats&&e.stats.stay)&&(r={},Object.keys(s.up||"").forEach(function(t){t=(s.up||"")[t],t.url&&(r[t.url]={})}),(w.axe=w.axe||{}).up=r)},1e3*9)},setTimeout(function(w){(w=e.stats&&e.stats.stay&&e.stats.stay.axe)&&(w=w.up)&&(w instanceof Array||(w=Object.keys(w)),setTimeout.each(w||[],function(r){y.hear.opt({opt:{peers:r}})}))},1e3)})(),function(){a.mob=a.mob||9900,e.on("hi",function(l){if(this.to.next(l),!l.url){var w=y.near;if(!(a.mob>=w)){var r={};Object.keys(s.up).forEach(function(t){t=s.up[t],t.url&&(r[t.url]={})}),y.say({dam:"mob",mob:w,peers:r},l),setTimeout(function(){y.bye(l)},9)}}}),e.on("bye",function(l){this.to.next(l)})}()}return function(){var e=Array.from;if(Object.maps=function(a){return e&&a instanceof Map?e(a.keys()):(a instanceof Object.Map&&(a=a.s),Object.keys(a))},e)return Object.Map=Map;(Object.Map=function(){this.s={}}).prototype={set:function(a,s){return this.s[a]=s,this},get:function(a){return this.s[a]},delete:function(a){delete this.s[a]}}}(),nt}(function(J){(function(){var g=setTimeout||{},G;typeof window!=""+G&&(g.window=window);var $=(g.window||"").AXE||function(){};($.window=g.window)&&($.window.AXE=$);var e=($.window||"").GUN||V;(e.AXE=$).GUN=$.Gun=e,e.window||lt(),e.on("opt",function(s){a(s),this.to.next(s)});function a(s){if(s.axe)return;var y=s.opt,p=y.peers;if(y.axe===!1||!e.window)return;var f=e.window,u=f.localStorage||y.localStorage||{},o=f.location||y.location||{},v=f.navigator||y.navigator||{},S=s.axe={},n,d,l=y.mesh=y.mesh||e.Mesh(s);n=p[d=o.origin+"/gun"]=p[d]||{},n.id=n.url=d,n.retry=n.retry||0,n=p[d="http://localhost:8765/gun"]=p[d]||{},n.id=n.url=d,n.retry=n.retry||0,e.log.once("AXE","AXE enabled: Trying to find network via (1) local peer (2) last used peers (3) a URL parameter, and last (4) hard coded peers."),e.log.once("AXEWarn","Warning: AXE is in alpha, use only for testing!");var w=u.peers||"";w&&(w+=" "),w+=((o.search||"").split("peers=")[1]||"").split("&")[0],s.on("bye",function(t){this.to.next(t),t.url&&(v.onLine||(t.retry=1),!t.retry&&(S.fall&&delete S.fall[t.url||t.id],function c(){if(!S.fall){setTimeout(c,9);return}var h=Object.keys(S.fall||""),_=h[Math.random()*h.length>>0];if(h.length||(u.peers="",_="https://gunjs.herokuapp.com/gun"),p[_]){c();return}l.hi(_)}()))}),s.on("hi",function(t){this.to.next(t),t.url});function r(t){S.fall={},((t||"").match(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/ig)||[]).forEach(function(c){S.fall[c]={url:c,id:c,retry:0}})}if(w){r(w);return}try{fetch(((o.search||"").split("axe=")[1]||"").split("&")[0]||o.axe||"https://raw.githubusercontent.com/wiki/amark/gun/volunteer.dht.md").then(function(t){return t.text()}).then(function(t){r(u.peers=t)}).catch(function(){r()})}catch{r()}}try{""+G!="object"&&(J.exports=$)}catch{}})()})(ct);const ot=new st,q=ot.user().recall({sessionStorage:!0}),Q=ut("");q.get("alias").on(J=>Q.set(J));ot.on("auth",async J=>{const g=await q.get("alias");Q.set(g)});async function pt(J,g){return new Promise((G,$)=>{q.auth(J,g,e=>{e.err?$(e.err):G()})})}function yt(J,g){return new Promise((G,$)=>{q.create(J,g,e=>{e.err?$(e.err):G()})})}function dt(){return Q.set(""),new Promise((J,g)=>{q.leave(G=>{G.err?g(G.err):J()})})}export{Q as a,dt as b,at as g,pt as l,yt as r,q as u};
